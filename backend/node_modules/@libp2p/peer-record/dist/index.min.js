(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2PPeerRecord = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var Libp2PPeerRecord=(()=>{var zr=Object.defineProperty;var Vi=Object.getOwnPropertyDescriptor;var zi=Object.getOwnPropertyNames;var Fi=Object.prototype.hasOwnProperty;var pt=(r,t)=>{for(var e in t)zr(r,e,{get:t[e],enumerable:!0})},Gi=(r,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of zi(t))!Fi.call(r,o)&&o!==e&&zr(r,o,{get:()=>t[o],enumerable:!(n=Vi(t,o))||n.enumerable});return r};var ji=r=>Gi(zr({},"__esModule",{value:!0}),r);var yf={};pt(yf,{PeerRecord:()=>Hr,RecordEnvelope:()=>Cr});var Fr=Symbol.for("@libp2p/peer-id");var rt=class extends Error{static name="InvalidParametersError";constructor(t="Invalid parameters"){super(t),this.name="InvalidParametersError"}},be=class extends Error{static name="InvalidPublicKeyError";constructor(t="Invalid public key"){super(t),this.name="InvalidPublicKeyError"}};var nr=class extends Error{static name="InvalidMultihashError";constructor(t="Invalid Multihash"){super(t),this.name="InvalidMultihashError"}};var xe=class extends Error{static name="UnsupportedKeyTypeError";constructor(t="Unsupported key type"){super(t),this.name="UnsupportedKeyTypeError"}};var Yr={};pt(Yr,{base58btc:()=>Z,base58flickr:()=>Ji});var wf=new Uint8Array(0);function Vo(r,t){if(r===t)return!0;if(r.byteLength!==t.byteLength)return!1;for(let e=0;e<r.byteLength;e++)if(r[e]!==t[e])return!1;return!0}function Rt(r){if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")}function zo(r){return new TextEncoder().encode(r)}function Fo(r){return new TextDecoder().decode(r)}function Zi(r,t){if(r.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),n=0;n<e.length;n++)e[n]=255;for(var o=0;o<r.length;o++){var s=r.charAt(o),i=s.charCodeAt(0);if(e[i]!==255)throw new TypeError(s+" is ambiguous");e[i]=o}var a=r.length,c=r.charAt(0),f=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function l(w){if(w instanceof Uint8Array||(ArrayBuffer.isView(w)?w=new Uint8Array(w.buffer,w.byteOffset,w.byteLength):Array.isArray(w)&&(w=Uint8Array.from(w))),!(w instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(w.length===0)return"";for(var g=0,h=0,E=0,A=w.length;E!==A&&w[E]===0;)E++,g++;for(var m=(A-E)*u+1>>>0,B=new Uint8Array(m);E!==A;){for(var D=w[E],C=0,I=m-1;(D!==0||C<h)&&I!==-1;I--,C++)D+=256*B[I]>>>0,B[I]=D%a>>>0,D=D/a>>>0;if(D!==0)throw new Error("Non-zero carry");h=C,E++}for(var P=m-h;P!==m&&B[P]===0;)P++;for(var T=c.repeat(g);P<m;++P)T+=r.charAt(B[P]);return T}function p(w){if(typeof w!="string")throw new TypeError("Expected String");if(w.length===0)return new Uint8Array;var g=0;if(w[g]!==" "){for(var h=0,E=0;w[g]===c;)h++,g++;for(var A=(w.length-g)*f+1>>>0,m=new Uint8Array(A);w[g];){var B=e[w.charCodeAt(g)];if(B===255)return;for(var D=0,C=A-1;(B!==0||D<E)&&C!==-1;C--,D++)B+=a*m[C]>>>0,m[C]=B%256>>>0,B=B/256>>>0;if(B!==0)throw new Error("Non-zero carry");E=D,g++}if(w[g]!==" "){for(var I=A-E;I!==A&&m[I]===0;)I++;for(var P=new Uint8Array(h+(A-I)),T=h;I!==A;)P[T++]=m[I++];return P}}}function x(w){var g=p(w);if(g)return g;throw new Error(`Non-${t} character`)}return{encode:l,decodeUnsafe:p,decode:x}}var $i=Zi,Yi=$i,jo=Yi;var Gr=class{name;prefix;baseEncode;constructor(t,e,n){this.name=t,this.prefix=e,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},jr=class{name;prefix;baseDecode;prefixCodePoint;constructor(t,e,n){this.name=t,this.prefix=e;let o=e.codePointAt(0);if(o===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=o,this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Zo(this,t)}},Zr=class{decoders;constructor(t){this.decoders=t}or(t){return Zo(this,t)}decode(t){let e=t[0],n=this.decoders[e];if(n!=null)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function Zo(r,t){return new Zr({...r.decoders??{[r.prefix]:r},...t.decoders??{[t.prefix]:t}})}var $r=class{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(t,e,n,o){this.name=t,this.prefix=e,this.baseEncode=n,this.baseDecode=o,this.encoder=new Gr(t,e,n),this.decoder=new jr(t,e,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}};function we({name:r,prefix:t,encode:e,decode:n}){return new $r(r,t,e,n)}function Zt({name:r,prefix:t,alphabet:e}){let{encode:n,decode:o}=jo(e,r);return we({prefix:t,name:r,encode:n,decode:s=>Rt(o(s))})}function Wi(r,t,e,n){let o={};for(let u=0;u<t.length;++u)o[t[u]]=u;let s=r.length;for(;r[s-1]==="=";)--s;let i=new Uint8Array(s*e/8|0),a=0,c=0,f=0;for(let u=0;u<s;++u){let l=o[r[u]];if(l===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<e|l,a+=e,a>=8&&(a-=8,i[f++]=255&c>>a)}if(a>=e||(255&c<<8-a)!==0)throw new SyntaxError("Unexpected end of data");return i}function Xi(r,t,e){let n=t[t.length-1]==="=",o=(1<<e)-1,s="",i=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],i+=8;i>e;)i-=e,s+=t[o&a>>i];if(i!==0&&(s+=t[o&a<<e-i]),n)for(;(s.length*e&7)!==0;)s+="=";return s}function J({name:r,prefix:t,bitsPerChar:e,alphabet:n}){return we({prefix:t,name:r,encode(o){return Xi(o,n,e)},decode(o){return Wi(o,n,e,r)}})}var Z=Zt({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Ji=Zt({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Wr={};pt(Wr,{base32:()=>Nt,base32hex:()=>ra,base32hexpad:()=>oa,base32hexpadupper:()=>sa,base32hexupper:()=>na,base32pad:()=>ta,base32padupper:()=>ea,base32upper:()=>Qi,base32z:()=>ia});var Nt=J({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Qi=J({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),ta=J({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),ea=J({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),ra=J({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),na=J({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),oa=J({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),sa=J({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),ia=J({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Xr={};pt(Xr,{base36:()=>Ne,base36upper:()=>aa});var Ne=Zt({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),aa=Zt({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var ca=Wo,$o=128,ua=127,fa=~ua,la=Math.pow(2,31);function Wo(r,t,e){t=t||[],e=e||0;for(var n=e;r>=la;)t[e++]=r&255|$o,r/=128;for(;r&fa;)t[e++]=r&255|$o,r>>>=7;return t[e]=r|0,Wo.bytes=e-n+1,t}var ha=Jr,da=128,Yo=127;function Jr(r,n){var e=0,n=n||0,o=0,s=n,i,a=r.length;do{if(s>=a)throw Jr.bytes=0,new RangeError("Could not decode varint");i=r[s++],e+=o<28?(i&Yo)<<o:(i&Yo)*Math.pow(2,o),o+=7}while(i>=da);return Jr.bytes=s-n,e}var pa=Math.pow(2,7),ma=Math.pow(2,14),ya=Math.pow(2,21),ga=Math.pow(2,28),ba=Math.pow(2,35),xa=Math.pow(2,42),wa=Math.pow(2,49),Ea=Math.pow(2,56),Sa=Math.pow(2,63),Aa=function(r){return r<pa?1:r<ma?2:r<ya?3:r<ga?4:r<ba?5:r<xa?6:r<wa?7:r<Ea?8:r<Sa?9:10},va={encode:ca,decode:ha,encodingLength:Aa},Ba=va,ke=Ba;function Oe(r,t=0){return[ke.decode(r,t),ke.decode.bytes]}function Ee(r,t,e=0){return ke.encode(r,t,e),t}function Se(r){return ke.encodingLength(r)}function vt(r,t){let e=t.byteLength,n=Se(r),o=n+Se(e),s=new Uint8Array(o+e);return Ee(r,s,0),Ee(e,s,n),s.set(t,o),new Ae(r,e,t,s)}function ae(r){let t=Rt(r),[e,n]=Oe(t),[o,s]=Oe(t.subarray(n)),i=t.subarray(n+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new Ae(e,o,i,t)}function Xo(r,t){if(r===t)return!0;{let e=t;return r.code===e.code&&r.size===e.size&&e.bytes instanceof Uint8Array&&Vo(r.bytes,e.bytes)}}var Ae=class{code;size;digest;bytes;constructor(t,e,n,o){this.code=t,this.size=e,this.digest=n,this.bytes=o}};function Jo(r,t){let{bytes:e,version:n}=r;switch(n){case 0:return Ta(e,Qr(r),t??Z.encoder);default:return La(e,Qr(r),t??Nt.encoder)}}var Qo=new WeakMap;function Qr(r){let t=Qo.get(r);if(t==null){let e=new Map;return Qo.set(r,e),e}return t}var tt=class r{code;version;multihash;bytes;"/";constructor(t,e,n,o){this.code=e,this.version=t,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:t,multihash:e}=this;if(t!==Me)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(e.code!==Pa)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return r.createV0(e)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:t,digest:e}=this.multihash,n=vt(t,e);return r.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return r.equals(this,t)}static equals(t,e){let n=e;return n!=null&&t.code===n.code&&t.version===n.version&&Xo(t.multihash,n.multihash)}toString(t){return Jo(this,t)}toJSON(){return{"/":Jo(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(t==null)return null;let e=t;if(e instanceof r)return e;if(e["/"]!=null&&e["/"]===e.bytes||e.asCID===e){let{version:n,code:o,multihash:s,bytes:i}=e;return new r(n,o,s,i??ts(n,o,s.bytes))}else if(e[Ca]===!0){let{version:n,multihash:o,code:s}=e,i=ae(o);return r.create(n,s,i)}else return null}static create(t,e,n){if(typeof e!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:{if(e!==Me)throw new Error(`Version 0 CID must use dag-pb (code: ${Me}) block encoding`);return new r(t,e,n,n.bytes)}case 1:{let o=ts(t,e,n.bytes);return new r(t,e,n,o)}default:throw new Error("Invalid version")}}static createV0(t){return r.create(0,Me,t)}static createV1(t,e){return r.create(1,t,e)}static decode(t){let[e,n]=r.decodeFirst(t);if(n.length!==0)throw new Error("Incorrect length");return e}static decodeFirst(t){let e=r.inspectBytes(t),n=e.size-e.multihashSize,o=Rt(t.subarray(n,n+e.multihashSize));if(o.byteLength!==e.multihashSize)throw new Error("Incorrect length");let s=o.subarray(e.multihashSize-e.digestSize),i=new Ae(e.multihashCode,e.digestSize,s,o);return[e.version===0?r.createV0(i):r.createV1(e.codec,i),t.subarray(e.size)]}static inspectBytes(t){let e=0,n=()=>{let[l,p]=Oe(t.subarray(e));return e+=p,l},o=n(),s=Me;if(o===18?(o=0,e=0):s=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let i=e,a=n(),c=n(),f=e+c,u=f-i;return{version:o,codec:s,multihashCode:a,digestSize:c,multihashSize:u,size:f}}static parse(t,e){let[n,o]=Ia(t,e),s=r.decode(o);if(s.version===0&&t[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return Qr(s).set(n,t),s}};function Ia(r,t){switch(r[0]){case"Q":{let e=t??Z;return[Z.prefix,e.decode(`${Z.prefix}${r}`)]}case Z.prefix:{let e=t??Z;return[Z.prefix,e.decode(r)]}case Nt.prefix:{let e=t??Nt;return[Nt.prefix,e.decode(r)]}case Ne.prefix:{let e=t??Ne;return[Ne.prefix,e.decode(r)]}default:{if(t==null)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[r[0],t.decode(r)]}}}function Ta(r,t,e){let{prefix:n}=e;if(n!==Z.prefix)throw Error(`Cannot string encode V0 in ${e.name} encoding`);let o=t.get(n);if(o==null){let s=e.encode(r).slice(1);return t.set(n,s),s}else return o}function La(r,t,e){let{prefix:n}=e,o=t.get(n);if(o==null){let s=e.encode(r);return t.set(n,s),s}else return o}var Me=112,Pa=18;function ts(r,t,e){let n=Se(r),o=n+Se(t),s=new Uint8Array(o+e.byteLength);return Ee(r,s,0),Ee(t,s,n),s.set(e,o),s}var Ca=Symbol.for("@ipld/js-cid/CID");var tn={};pt(tn,{identity:()=>Bt});var es=0,Da="identity",rs=Rt;function Ua(r){return vt(es,rs(r))}var Bt={code:es,name:Da,encode:rs,digest:Ua};function it(r,t){if(r===t)return!0;if(r.byteLength!==t.byteLength)return!1;for(let e=0;e<r.byteLength;e++)if(r[e]!==t[e])return!1;return!0}function ut(r=0){return new Uint8Array(r)}function gt(r=0){return new Uint8Array(r)}function St(r,t){t==null&&(t=r.reduce((o,s)=>o+s.length,0));let e=gt(t),n=0;for(let o of r)e.set(o,n),n+=o.length;return e}var os=Symbol.for("@achingbrain/uint8arraylist");function ns(r,t){if(t==null||t<0)throw new RangeError("index is out of bounds");let e=0;for(let n of r){let o=e+n.byteLength;if(t<o)return{buf:n,index:t-e};e=o}throw new RangeError("index is out of bounds")}function sr(r){return!!r?.[os]}var mt=class r{bufs;length;[os]=!0;constructor(...t){this.bufs=[],this.length=0,t.length>0&&this.appendAll(t)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...t){this.appendAll(t)}appendAll(t){let e=0;for(let n of t)if(n instanceof Uint8Array)e+=n.byteLength,this.bufs.push(n);else if(sr(n))e+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=e}prepend(...t){this.prependAll(t)}prependAll(t){let e=0;for(let n of t.reverse())if(n instanceof Uint8Array)e+=n.byteLength,this.bufs.unshift(n);else if(sr(n))e+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=e}get(t){let e=ns(this.bufs,t);return e.buf[e.index]}set(t,e){let n=ns(this.bufs,t);n.buf[n.index]=e}write(t,e=0){if(t instanceof Uint8Array)for(let n=0;n<t.length;n++)this.set(e+n,t[n]);else if(sr(t))for(let n=0;n<t.length;n++)this.set(e+n,t.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(t){if(t=Math.trunc(t),!(Number.isNaN(t)||t<=0)){if(t===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(t>=this.bufs[0].byteLength)t-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(t),this.length-=t;break}}}slice(t,e){let{bufs:n,length:o}=this._subList(t,e);return St(n,o)}subarray(t,e){let{bufs:n,length:o}=this._subList(t,e);return n.length===1?n[0]:St(n,o)}sublist(t,e){let{bufs:n,length:o}=this._subList(t,e),s=new r;return s.length=o,s.bufs=[...n],s}_subList(t,e){if(t=t??0,e=e??this.length,t<0&&(t=this.length+t),e<0&&(e=this.length+e),t<0||e>this.length)throw new RangeError("index is out of bounds");if(t===e)return{bufs:[],length:0};if(t===0&&e===this.length)return{bufs:this.bufs,length:this.length};let n=[],o=0;for(let s=0;s<this.bufs.length;s++){let i=this.bufs[s],a=o,c=a+i.byteLength;if(o=c,t>=c)continue;let f=t>=a&&t<c,u=e>a&&e<=c;if(f&&u){if(t===a&&e===c){n.push(i);break}let l=t-a;n.push(i.subarray(l,l+(e-t)));break}if(f){if(t===0){n.push(i);continue}n.push(i.subarray(t-a));continue}if(u){if(e===c){n.push(i);break}n.push(i.subarray(0,e-a));break}n.push(i)}return{bufs:n,length:e-t}}indexOf(t,e=0){if(!sr(t)&&!(t instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');let n=t instanceof Uint8Array?t:t.subarray();if(e=Number(e??0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),t.length===0)return e>this.length?this.length:e;let o=n.byteLength;if(o===0)throw new TypeError("search must be at least 1 byte long");let s=256,i=new Int32Array(s);for(let l=0;l<s;l++)i[l]=-1;for(let l=0;l<o;l++)i[n[l]]=l;let a=i,c=this.byteLength-n.byteLength,f=n.byteLength-1,u;for(let l=e;l<=c;l+=u){u=0;for(let p=f;p>=0;p--){let x=this.get(l+p);if(n[p]!==x){u=Math.max(1,p-a[x]);break}}if(u===0)return l}return-1}getInt8(t){let e=this.subarray(t,t+1);return new DataView(e.buffer,e.byteOffset,e.byteLength).getInt8(0)}setInt8(t,e){let n=gt(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,e),this.write(n,t)}getInt16(t,e){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,e)}setInt16(t,e,n){let o=ut(2);new DataView(o.buffer,o.byteOffset,o.byteLength).setInt16(0,e,n),this.write(o,t)}getInt32(t,e){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,e)}setInt32(t,e,n){let o=ut(4);new DataView(o.buffer,o.byteOffset,o.byteLength).setInt32(0,e,n),this.write(o,t)}getBigInt64(t,e){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,e)}setBigInt64(t,e,n){let o=ut(8);new DataView(o.buffer,o.byteOffset,o.byteLength).setBigInt64(0,e,n),this.write(o,t)}getUint8(t){let e=this.subarray(t,t+1);return new DataView(e.buffer,e.byteOffset,e.byteLength).getUint8(0)}setUint8(t,e){let n=gt(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,e),this.write(n,t)}getUint16(t,e){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,e)}setUint16(t,e,n){let o=ut(2);new DataView(o.buffer,o.byteOffset,o.byteLength).setUint16(0,e,n),this.write(o,t)}getUint32(t,e){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,e)}setUint32(t,e,n){let o=ut(4);new DataView(o.buffer,o.byteOffset,o.byteLength).setUint32(0,e,n),this.write(o,t)}getBigUint64(t,e){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,e)}setBigUint64(t,e,n){let o=ut(8);new DataView(o.buffer,o.byteOffset,o.byteLength).setBigUint64(0,e,n),this.write(o,t)}getFloat32(t,e){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,e)}setFloat32(t,e,n){let o=ut(4);new DataView(o.buffer,o.byteOffset,o.byteLength).setFloat32(0,e,n),this.write(o,t)}getFloat64(t,e){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,e)}setFloat64(t,e,n){let o=ut(8);new DataView(o.buffer,o.byteOffset,o.byteLength).setFloat64(0,e,n),this.write(o,t)}equals(t){if(t==null||!(t instanceof r)||t.bufs.length!==this.bufs.length)return!1;for(let e=0;e<this.bufs.length;e++)if(!it(this.bufs[e],t.bufs[e]))return!1;return!0}static fromUint8Arrays(t,e){let n=new r;return n.bufs=t,e==null&&(e=t.reduce((o,s)=>o+s.byteLength,0)),n.length=e,n}};var en={};pt(en,{base10:()=>_a});var _a=Zt({prefix:"9",name:"base10",alphabet:"0123456789"});var rn={};pt(rn,{base16:()=>Ka,base16upper:()=>Ra});var Ka=J({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Ra=J({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var nn={};pt(nn,{base2:()=>Na});var Na=J({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var on={};pt(on,{base256emoji:()=>Ha});var ss=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),ka=ss.reduce((r,t,e)=>(r[e]=t,r),[]),Oa=ss.reduce((r,t,e)=>{let n=t.codePointAt(0);if(n==null)throw new Error(`Invalid character: ${t}`);return r[n]=e,r},[]);function Ma(r){return r.reduce((t,e)=>(t+=ka[e],t),"")}function qa(r){let t=[];for(let e of r){let n=e.codePointAt(0);if(n==null)throw new Error(`Invalid character: ${e}`);let o=Oa[n];if(o==null)throw new Error(`Non-base256emoji character: ${e}`);t.push(o)}return new Uint8Array(t)}var Ha=we({prefix:"\u{1F680}",name:"base256emoji",encode:Ma,decode:qa});var sn={};pt(sn,{base64:()=>Va,base64pad:()=>za,base64url:()=>Fa,base64urlpad:()=>Ga});var Va=J({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),za=J({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Fa=J({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Ga=J({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var an={};pt(an,{base8:()=>ja});var ja=J({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var cn={};pt(cn,{identity:()=>Za});var Za=we({prefix:"\0",name:"identity",encode:r=>Fo(r),decode:r=>zo(r)});var nl=new TextEncoder,ol=new TextDecoder;var ln={};pt(ln,{sha256:()=>qe,sha512:()=>Wa});function fn({name:r,code:t,encode:e}){return new un(r,t,e)}var un=class{name;code;encode;constructor(t,e,n){this.name=t,this.code=e,this.encode=n}digest(t){if(t instanceof Uint8Array){let e=this.encode(t);return e instanceof Uint8Array?vt(this.code,e):e.then(n=>vt(this.code,n))}else throw Error("Unknown type, must be binary type")}};function as(r){return async t=>new Uint8Array(await crypto.subtle.digest(r,t))}var qe=fn({name:"sha2-256",code:18,encode:as("SHA-256")}),Wa=fn({name:"sha2-512",code:19,encode:as("SHA-512")});var He={...cn,...nn,...an,...en,...rn,...Wr,...Xr,...Yr,...sn,...on},yl={...ln,...tn};function us(r,t,e,n){return{name:r,prefix:t,encoder:{name:r,prefix:t,encode:e},decoder:{decode:n}}}var cs=us("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),hn=us("ascii","a",r=>{let t="a";for(let e=0;e<r.length;e++)t+=String.fromCharCode(r[e]);return t},r=>{r=r.substring(1);let t=gt(r.length);for(let e=0;e<r.length;e++)t[e]=r.charCodeAt(e);return t}),Xa={utf8:cs,"utf-8":cs,hex:He.base16,latin1:hn,ascii:hn,binary:hn,...He},ir=Xa;function F(r,t="utf8"){let e=ir[t];if(e==null)throw new Error(`Unsupported encoding "${t}"`);return e.decoder.decode(`${e.prefix}${r}`)}function k(r,t="utf8"){let e=ir[t];if(e==null)throw new Error(`Unsupported encoding "${t}"`);return e.encoder.encode(r).substring(1)}var Ja=parseInt("11111",2),dn=parseInt("10000000",2),Qa=parseInt("01111111",2),fs={0:Ve,1:Ve,2:tc,3:nc,4:oc,5:rc,6:ec,16:Ve,22:Ve,48:Ve};function kt(r,t={offset:0}){let e=r[t.offset]&Ja;if(t.offset++,fs[e]!=null)return fs[e](r,t);throw new Error("No decoder for tag "+e)}function ze(r,t){let e=0;if((r[t.offset]&dn)===dn){let n=r[t.offset]&Qa,o="0x";t.offset++;for(let s=0;s<n;s++,t.offset++)o+=r[t.offset].toString(16).padStart(2,"0");e=parseInt(o,16)}else e=r[t.offset],t.offset++;return e}function Ve(r,t){ze(r,t);let e=[];for(;!(t.offset>=r.byteLength);){let n=kt(r,t);if(n===null)break;e.push(n)}return e}function tc(r,t){let e=ze(r,t),n=t.offset,o=t.offset+e,s=[];for(let i=n;i<o;i++)i===n&&r[i]===0||s.push(r[i]);return t.offset+=e,Uint8Array.from(s)}function ec(r,t){let e=ze(r,t),n=t.offset+e,o=r[t.offset];t.offset++;let s=0,i=0;o<40?(s=0,i=o):o<80?(s=1,i=o-40):(s=2,i=o-80);let a=`${s}.${i}`,c=[];for(;t.offset<n;){let f=r[t.offset];if(t.offset++,c.push(f&127),f<128){c.reverse();let u=0;for(let l=0;l<c.length;l++)u+=c[l]<<l*7;a+=`.${u}`,c=[]}}return a}function rc(r,t){return t.offset++,null}function nc(r,t){let e=ze(r,t),n=r[t.offset];t.offset++;let o=r.subarray(t.offset,t.offset+e-1);if(t.offset+=e,n!==0)throw new Error("Unused bits in bit string is unimplemented");return o}function oc(r,t){let e=ze(r,t),n=r.subarray(t.offset,t.offset+e);return t.offset+=e,n}function sc(r){let t=r.toString(16);t.length%2===1&&(t="0"+t);let e=new mt;for(let n=0;n<t.length;n+=2)e.append(Uint8Array.from([parseInt(`${t[n]}${t[n+1]}`,16)]));return e}function pn(r){if(r.byteLength<128)return Uint8Array.from([r.byteLength]);let t=sc(r.byteLength);return new mt(Uint8Array.from([t.byteLength|dn]),t)}function bt(r){let t=new mt,e=128;return(r.subarray()[0]&e)===e&&t.append(Uint8Array.from([0])),t.append(r),new mt(Uint8Array.from([2]),pn(t),t)}function ar(r){let t=Uint8Array.from([0]),e=new mt(t,r);return new mt(Uint8Array.from([3]),pn(e),e)}function Yt(r,t=48){let e=new mt;for(let n of r)e.append(n);return new mt(Uint8Array.from([t]),pn(e),e)}async function ls(r,t,e){let n=await crypto.subtle.importKey("jwk",r,{name:"ECDSA",namedCurve:r.crv??"P-256"},!1,["verify"]);return crypto.subtle.verify({name:"ECDSA",hash:{name:"SHA-256"}},n,t,e.subarray())}var ic=Uint8Array.from([6,8,42,134,72,206,61,3,1,7]),ac=Uint8Array.from([6,5,43,129,4,0,34]),cc=Uint8Array.from([6,5,43,129,4,0,35]),uc={ext:!0,kty:"EC",crv:"P-256"},fc={ext:!0,kty:"EC",crv:"P-384"},lc={ext:!0,kty:"EC",crv:"P-521"},mn=32,yn=48,gn=66;function bn(r){let t=kt(r);return hs(t)}function hs(r){let t=r[1][1][0],e=1,n,o;if(t.byteLength===mn*2+1)return n=k(t.subarray(e,e+mn),"base64url"),o=k(t.subarray(e+mn),"base64url"),new ve({...uc,key_ops:["verify"],x:n,y:o});if(t.byteLength===yn*2+1)return n=k(t.subarray(e,e+yn),"base64url"),o=k(t.subarray(e+yn),"base64url"),new ve({...fc,key_ops:["verify"],x:n,y:o});if(t.byteLength===gn*2+1)return n=k(t.subarray(e,e+gn),"base64url"),o=k(t.subarray(e+gn),"base64url"),new ve({...lc,key_ops:["verify"],x:n,y:o});throw new rt(`coordinates were wrong length, got ${t.byteLength}, expected 65, 97 or 133`)}function ds(r){return Yt([bt(Uint8Array.from([1])),Yt([hc(r.crv)],160),Yt([ar(new mt(Uint8Array.from([4]),F(r.x??"","base64url"),F(r.y??"","base64url")))],161)]).subarray()}function hc(r){if(r==="P-256")return ic;if(r==="P-384")return ac;if(r==="P-521")return cc;throw new rt(`Invalid curve ${r}`)}var ve=class{type="ECDSA";jwk;_raw;constructor(t){this.jwk=t}get raw(){return this._raw==null&&(this._raw=ds(this.jwk)),this._raw}toMultihash(){return Bt.digest(Wt(this))}toCID(){return tt.createV1(114,this.toMultihash())}toString(){return Z.encode(this.toMultihash().bytes).substring(1)}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:it(this.raw,t.raw)}async verify(t,e){return ls(this.jwk,e,t)}};function ps(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function dc(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function Be(r,...t){if(!dc(r))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(r.length))throw new Error("Uint8Array expected of length "+t+", got length="+r.length)}function ms(r){if(typeof r!="function"||typeof r.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");ps(r.outputLen),ps(r.blockLen)}function Ie(r,t=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(t&&r.finished)throw new Error("Hash#digest() has already been called")}function ys(r,t){Be(r);let e=t.outputLen;if(r.length<e)throw new Error("digestInto() expects output buffer of length at least "+e)}var ce=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function cr(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function It(r,t){return r<<32-t|r>>>t}function gs(r){if(typeof r!="string")throw new Error("utf8ToBytes expected string, got "+typeof r);return new Uint8Array(new TextEncoder().encode(r))}function Fe(r){return typeof r=="string"&&(r=gs(r)),Be(r),r}function xn(...r){let t=0;for(let n=0;n<r.length;n++){let o=r[n];Be(o),t+=o.length}let e=new Uint8Array(t);for(let n=0,o=0;n<r.length;n++){let s=r[n];e.set(s,o),o+=s.length}return e}var Te=class{clone(){return this._cloneInto()}};function ur(r){let t=n=>r().update(Fe(n)).digest(),e=r();return t.outputLen=e.outputLen,t.blockLen=e.blockLen,t.create=()=>r(),t}function fr(r=32){if(ce&&typeof ce.getRandomValues=="function")return ce.getRandomValues(new Uint8Array(r));if(ce&&typeof ce.randomBytes=="function")return ce.randomBytes(r);throw new Error("crypto.getRandomValues must be defined")}function pc(r,t,e,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(t,e,n);let o=BigInt(32),s=BigInt(4294967295),i=Number(e>>o&s),a=Number(e&s),c=n?4:0,f=n?0:4;r.setUint32(t+c,i,n),r.setUint32(t+f,a,n)}function bs(r,t,e){return r&t^~r&e}function xs(r,t,e){return r&t^r&e^t&e}var Le=class extends Te{constructor(t,e,n,o){super(),this.blockLen=t,this.outputLen=e,this.padOffset=n,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=cr(this.buffer)}update(t){Ie(this);let{view:e,buffer:n,blockLen:o}=this;t=Fe(t);let s=t.length;for(let i=0;i<s;){let a=Math.min(o-this.pos,s-i);if(a===o){let c=cr(t);for(;o<=s-i;i+=o)this.process(c,i);continue}n.set(t.subarray(i,i+a),this.pos),this.pos+=a,i+=a,this.pos===o&&(this.process(e,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Ie(this),ys(t,this),this.finished=!0;let{buffer:e,view:n,blockLen:o,isLE:s}=this,{pos:i}=this;e[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>o-i&&(this.process(n,0),i=0);for(let l=i;l<o;l++)e[l]=0;pc(n,o-8,BigInt(this.length*8),s),this.process(n,0);let a=cr(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let f=c/4,u=this.get();if(f>u.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<f;l++)a.setUint32(4*l,u[l],s)}digest(){let{buffer:t,outputLen:e}=this;this.digestInto(t);let n=t.slice(0,e);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:e,buffer:n,length:o,finished:s,destroyed:i,pos:a}=this;return t.length=o,t.pos=a,t.finished=s,t.destroyed=i,o%e&&t.buffer.set(n),t}};var lr=BigInt(4294967295),wn=BigInt(32);function ws(r,t=!1){return t?{h:Number(r&lr),l:Number(r>>wn&lr)}:{h:Number(r>>wn&lr)|0,l:Number(r&lr)|0}}function mc(r,t=!1){let e=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let o=0;o<r.length;o++){let{h:s,l:i}=ws(r[o],t);[e[o],n[o]]=[s,i]}return[e,n]}var yc=(r,t)=>BigInt(r>>>0)<<wn|BigInt(t>>>0),gc=(r,t,e)=>r>>>e,bc=(r,t,e)=>r<<32-e|t>>>e,xc=(r,t,e)=>r>>>e|t<<32-e,wc=(r,t,e)=>r<<32-e|t>>>e,Ec=(r,t,e)=>r<<64-e|t>>>e-32,Sc=(r,t,e)=>r>>>e-32|t<<64-e,Ac=(r,t)=>t,vc=(r,t)=>r,Bc=(r,t,e)=>r<<e|t>>>32-e,Ic=(r,t,e)=>t<<e|r>>>32-e,Tc=(r,t,e)=>t<<e-32|r>>>64-e,Lc=(r,t,e)=>r<<e-32|t>>>64-e;function Pc(r,t,e,n){let o=(t>>>0)+(n>>>0);return{h:r+e+(o/2**32|0)|0,l:o|0}}var Cc=(r,t,e)=>(r>>>0)+(t>>>0)+(e>>>0),Dc=(r,t,e,n)=>t+e+n+(r/2**32|0)|0,Uc=(r,t,e,n)=>(r>>>0)+(t>>>0)+(e>>>0)+(n>>>0),_c=(r,t,e,n,o)=>t+e+n+o+(r/2**32|0)|0,Kc=(r,t,e,n,o)=>(r>>>0)+(t>>>0)+(e>>>0)+(n>>>0)+(o>>>0),Rc=(r,t,e,n,o,s)=>t+e+n+o+s+(r/2**32|0)|0;var Nc={fromBig:ws,split:mc,toBig:yc,shrSH:gc,shrSL:bc,rotrSH:xc,rotrSL:wc,rotrBH:Ec,rotrBL:Sc,rotr32H:Ac,rotr32L:vc,rotlSH:Bc,rotlSL:Ic,rotlBH:Tc,rotlBL:Lc,add:Pc,add3L:Cc,add3H:Dc,add4L:Uc,add4H:_c,add5H:Rc,add5L:Kc},R=Nc;var[kc,Oc]=R.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))),Xt=new Uint32Array(80),Jt=new Uint32Array(80),En=class extends Le{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:t,Al:e,Bh:n,Bl:o,Ch:s,Cl:i,Dh:a,Dl:c,Eh:f,El:u,Fh:l,Fl:p,Gh:x,Gl:w,Hh:g,Hl:h}=this;return[t,e,n,o,s,i,a,c,f,u,l,p,x,w,g,h]}set(t,e,n,o,s,i,a,c,f,u,l,p,x,w,g,h){this.Ah=t|0,this.Al=e|0,this.Bh=n|0,this.Bl=o|0,this.Ch=s|0,this.Cl=i|0,this.Dh=a|0,this.Dl=c|0,this.Eh=f|0,this.El=u|0,this.Fh=l|0,this.Fl=p|0,this.Gh=x|0,this.Gl=w|0,this.Hh=g|0,this.Hl=h|0}process(t,e){for(let m=0;m<16;m++,e+=4)Xt[m]=t.getUint32(e),Jt[m]=t.getUint32(e+=4);for(let m=16;m<80;m++){let B=Xt[m-15]|0,D=Jt[m-15]|0,C=R.rotrSH(B,D,1)^R.rotrSH(B,D,8)^R.shrSH(B,D,7),I=R.rotrSL(B,D,1)^R.rotrSL(B,D,8)^R.shrSL(B,D,7),P=Xt[m-2]|0,T=Jt[m-2]|0,$=R.rotrSH(P,T,19)^R.rotrBH(P,T,61)^R.shrSH(P,T,6),q=R.rotrSL(P,T,19)^R.rotrBL(P,T,61)^R.shrSL(P,T,6),O=R.add4L(I,q,Jt[m-7],Jt[m-16]),et=R.add4H(O,C,$,Xt[m-7],Xt[m-16]);Xt[m]=et|0,Jt[m]=O|0}let{Ah:n,Al:o,Bh:s,Bl:i,Ch:a,Cl:c,Dh:f,Dl:u,Eh:l,El:p,Fh:x,Fl:w,Gh:g,Gl:h,Hh:E,Hl:A}=this;for(let m=0;m<80;m++){let B=R.rotrSH(l,p,14)^R.rotrSH(l,p,18)^R.rotrBH(l,p,41),D=R.rotrSL(l,p,14)^R.rotrSL(l,p,18)^R.rotrBL(l,p,41),C=l&x^~l&g,I=p&w^~p&h,P=R.add5L(A,D,I,Oc[m],Jt[m]),T=R.add5H(P,E,B,C,kc[m],Xt[m]),$=P|0,q=R.rotrSH(n,o,28)^R.rotrBH(n,o,34)^R.rotrBH(n,o,39),O=R.rotrSL(n,o,28)^R.rotrBL(n,o,34)^R.rotrBL(n,o,39),et=n&s^n&a^s&a,S=o&i^o&c^i&c;E=g|0,A=h|0,g=x|0,h=w|0,x=l|0,w=p|0,{h:l,l:p}=R.add(f|0,u|0,T|0,$|0),f=a|0,u=c|0,a=s|0,c=i|0,s=n|0,i=o|0;let L=R.add3L($,O,S);n=R.add3H(L,T,q,et),o=L|0}({h:n,l:o}=R.add(this.Ah|0,this.Al|0,n|0,o|0)),{h:s,l:i}=R.add(this.Bh|0,this.Bl|0,s|0,i|0),{h:a,l:c}=R.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:f,l:u}=R.add(this.Dh|0,this.Dl|0,f|0,u|0),{h:l,l:p}=R.add(this.Eh|0,this.El|0,l|0,p|0),{h:x,l:w}=R.add(this.Fh|0,this.Fl|0,x|0,w|0),{h:g,l:h}=R.add(this.Gh|0,this.Gl|0,g|0,h|0),{h:E,l:A}=R.add(this.Hh|0,this.Hl|0,E|0,A|0),this.set(n,o,s,i,a,c,f,u,l,p,x,w,g,h,E,A)}roundClean(){Xt.fill(0),Jt.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var Es=ur(()=>new En);var pr={};pt(pr,{aInRange:()=>xt,abool:()=>Tt,abytes:()=>Pe,bitGet:()=>Fc,bitLen:()=>Bn,bitMask:()=>je,bitSet:()=>Gc,bytesToHex:()=>Mt,bytesToNumberBE:()=>qt,bytesToNumberLE:()=>te,concatBytes:()=>Ht,createHmacDrbg:()=>In,ensureBytes:()=>X,equalBytes:()=>Vc,hexToBytes:()=>fe,hexToNumber:()=>vn,inRange:()=>Ge,isBytes:()=>Qt,memoized:()=>he,notImplemented:()=>Zc,numberToBytesBE:()=>ee,numberToBytesLE:()=>le,numberToHexUnpadded:()=>ue,numberToVarBytesBE:()=>Hc,utf8ToBytes:()=>zc,validateObject:()=>Dt});var hr=BigInt(0),dr=BigInt(1),Mc=BigInt(2);function Qt(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function Pe(r){if(!Qt(r))throw new Error("Uint8Array expected")}function Tt(r,t){if(typeof t!="boolean")throw new Error(r+" boolean expected, got "+t)}var qc=Array.from({length:256},(r,t)=>t.toString(16).padStart(2,"0"));function Mt(r){Pe(r);let t="";for(let e=0;e<r.length;e++)t+=qc[r[e]];return t}function ue(r){let t=r.toString(16);return t.length&1?"0"+t:t}function vn(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return r===""?hr:BigInt("0x"+r)}var Ot={_0:48,_9:57,A:65,F:70,a:97,f:102};function Ss(r){if(r>=Ot._0&&r<=Ot._9)return r-Ot._0;if(r>=Ot.A&&r<=Ot.F)return r-(Ot.A-10);if(r>=Ot.a&&r<=Ot.f)return r-(Ot.a-10)}function fe(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);let t=r.length,e=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let n=new Uint8Array(e);for(let o=0,s=0;o<e;o++,s+=2){let i=Ss(r.charCodeAt(s)),a=Ss(r.charCodeAt(s+1));if(i===void 0||a===void 0){let c=r[s]+r[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}n[o]=i*16+a}return n}function qt(r){return vn(Mt(r))}function te(r){return Pe(r),vn(Mt(Uint8Array.from(r).reverse()))}function ee(r,t){return fe(r.toString(16).padStart(t*2,"0"))}function le(r,t){return ee(r,t).reverse()}function Hc(r){return fe(ue(r))}function X(r,t,e){let n;if(typeof t=="string")try{n=fe(t)}catch(s){throw new Error(r+" must be hex string or Uint8Array, cause: "+s)}else if(Qt(t))n=Uint8Array.from(t);else throw new Error(r+" must be hex string or Uint8Array");let o=n.length;if(typeof e=="number"&&o!==e)throw new Error(r+" of length "+e+" expected, got "+o);return n}function Ht(...r){let t=0;for(let n=0;n<r.length;n++){let o=r[n];Pe(o),t+=o.length}let e=new Uint8Array(t);for(let n=0,o=0;n<r.length;n++){let s=r[n];e.set(s,o),o+=s.length}return e}function Vc(r,t){if(r.length!==t.length)return!1;let e=0;for(let n=0;n<r.length;n++)e|=r[n]^t[n];return e===0}function zc(r){if(typeof r!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(r))}var Sn=r=>typeof r=="bigint"&&hr<=r;function Ge(r,t,e){return Sn(r)&&Sn(t)&&Sn(e)&&t<=r&&r<e}function xt(r,t,e,n){if(!Ge(t,e,n))throw new Error("expected valid "+r+": "+e+" <= n < "+n+", got "+t)}function Bn(r){let t;for(t=0;r>hr;r>>=dr,t+=1);return t}function Fc(r,t){return r>>BigInt(t)&dr}function Gc(r,t,e){return r|(e?dr:hr)<<BigInt(t)}var je=r=>(Mc<<BigInt(r-1))-dr,An=r=>new Uint8Array(r),As=r=>Uint8Array.from(r);function In(r,t,e){if(typeof r!="number"||r<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof e!="function")throw new Error("hmacFn must be a function");let n=An(r),o=An(r),s=0,i=()=>{n.fill(1),o.fill(0),s=0},a=(...l)=>e(o,n,...l),c=(l=An())=>{o=a(As([0]),l),n=a(),l.length!==0&&(o=a(As([1]),l),n=a())},f=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let l=0,p=[];for(;l<t;){n=a();let x=n.slice();p.push(x),l+=n.length}return Ht(...p)};return(l,p)=>{i(),c(l);let x;for(;!(x=p(f()));)c();return i(),x}}var jc={bigint:r=>typeof r=="bigint",function:r=>typeof r=="function",boolean:r=>typeof r=="boolean",string:r=>typeof r=="string",stringOrUint8Array:r=>typeof r=="string"||Qt(r),isSafeInteger:r=>Number.isSafeInteger(r),array:r=>Array.isArray(r),field:(r,t)=>t.Fp.isValid(r),hash:r=>typeof r=="function"&&Number.isSafeInteger(r.outputLen)};function Dt(r,t,e={}){let n=(o,s,i)=>{let a=jc[s];if(typeof a!="function")throw new Error("invalid validator function");let c=r[o];if(!(i&&c===void 0)&&!a(c,r))throw new Error("param "+String(o)+" is invalid. Expected "+s+", got "+c)};for(let[o,s]of Object.entries(t))n(o,s,!1);for(let[o,s]of Object.entries(e))n(o,s,!0);return r}var Zc=()=>{throw new Error("not implemented")};function he(r){let t=new WeakMap;return(e,...n)=>{let o=t.get(e);if(o!==void 0)return o;let s=r(e,...n);return t.set(e,s),s}}var nt=BigInt(0),Y=BigInt(1),de=BigInt(2),$c=BigInt(3),Tn=BigInt(4),vs=BigInt(5),Bs=BigInt(8),Yc=BigInt(9),Wc=BigInt(16);function z(r,t){let e=r%t;return e>=nt?e:t+e}function Xc(r,t,e){if(t<nt)throw new Error("invalid exponent, negatives unsupported");if(e<=nt)throw new Error("invalid modulus");if(e===Y)return nt;let n=Y;for(;t>nt;)t&Y&&(n=n*r%e),r=r*r%e,t>>=Y;return n}function W(r,t,e){let n=r;for(;t-- >nt;)n*=n,n%=e;return n}function mr(r,t){if(r===nt)throw new Error("invert: expected non-zero number");if(t<=nt)throw new Error("invert: expected positive modulus, got "+t);let e=z(r,t),n=t,o=nt,s=Y,i=Y,a=nt;for(;e!==nt;){let f=n/e,u=n%e,l=o-i*f,p=s-a*f;n=e,e=u,o=i,s=a,i=l,a=p}if(n!==Y)throw new Error("invert: does not exist");return z(o,t)}function Jc(r){let t=(r-Y)/de,e,n,o;for(e=r-Y,n=0;e%de===nt;e/=de,n++);for(o=de;o<r&&Xc(o,t,r)!==r-Y;o++)if(o>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){let i=(r+Y)/Tn;return function(c,f){let u=c.pow(f,i);if(!c.eql(c.sqr(u),f))throw new Error("Cannot find square root");return u}}let s=(e+Y)/de;return function(a,c){if(a.pow(c,t)===a.neg(a.ONE))throw new Error("Cannot find square root");let f=n,u=a.pow(a.mul(a.ONE,o),e),l=a.pow(c,s),p=a.pow(c,e);for(;!a.eql(p,a.ONE);){if(a.eql(p,a.ZERO))return a.ZERO;let x=1;for(let g=a.sqr(p);x<f&&!a.eql(g,a.ONE);x++)g=a.sqr(g);let w=a.pow(u,Y<<BigInt(f-x-1));u=a.sqr(w),l=a.mul(l,w),p=a.mul(p,u),f=x}return l}}function Qc(r){if(r%Tn===$c){let t=(r+Y)/Tn;return function(n,o){let s=n.pow(o,t);if(!n.eql(n.sqr(s),o))throw new Error("Cannot find square root");return s}}if(r%Bs===vs){let t=(r-vs)/Bs;return function(n,o){let s=n.mul(o,de),i=n.pow(s,t),a=n.mul(o,i),c=n.mul(n.mul(a,de),i),f=n.mul(a,n.sub(c,n.ONE));if(!n.eql(n.sqr(f),o))throw new Error("Cannot find square root");return f}}return r%Wc,Jc(r)}var Is=(r,t)=>(z(r,t)&Y)===Y,tu=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Ln(r){let t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},e=tu.reduce((n,o)=>(n[o]="function",n),t);return Dt(r,e)}function eu(r,t,e){if(e<nt)throw new Error("invalid exponent, negatives unsupported");if(e===nt)return r.ONE;if(e===Y)return t;let n=r.ONE,o=t;for(;e>nt;)e&Y&&(n=r.mul(n,o)),o=r.sqr(o),e>>=Y;return n}function ru(r,t){let e=new Array(t.length),n=t.reduce((s,i,a)=>r.is0(i)?s:(e[a]=s,r.mul(s,i)),r.ONE),o=r.inv(n);return t.reduceRight((s,i,a)=>r.is0(i)?s:(e[a]=r.mul(s,e[a]),r.mul(s,i)),o),e}function Pn(r,t){let e=t!==void 0?t:r.toString(2).length,n=Math.ceil(e/8);return{nBitLength:e,nByteLength:n}}function re(r,t,e=!1,n={}){if(r<=nt)throw new Error("invalid field: expected ORDER > 0, got "+r);let{nBitLength:o,nByteLength:s}=Pn(r,t);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let i,a=Object.freeze({ORDER:r,isLE:e,BITS:o,BYTES:s,MASK:je(o),ZERO:nt,ONE:Y,create:c=>z(c,r),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return nt<=c&&c<r},is0:c=>c===nt,isOdd:c=>(c&Y)===Y,neg:c=>z(-c,r),eql:(c,f)=>c===f,sqr:c=>z(c*c,r),add:(c,f)=>z(c+f,r),sub:(c,f)=>z(c-f,r),mul:(c,f)=>z(c*f,r),pow:(c,f)=>eu(a,c,f),div:(c,f)=>z(c*mr(f,r),r),sqrN:c=>c*c,addN:(c,f)=>c+f,subN:(c,f)=>c-f,mulN:(c,f)=>c*f,inv:c=>mr(c,r),sqrt:n.sqrt||(c=>(i||(i=Qc(r)),i(a,c))),invertBatch:c=>ru(a,c),cmov:(c,f,u)=>u?f:c,toBytes:c=>e?le(c,s):ee(c,s),fromBytes:c=>{if(c.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+c.length);return e?te(c):qt(c)}});return Object.freeze(a)}function Ts(r){if(typeof r!="bigint")throw new Error("field order must be bigint");let t=r.toString(2).length;return Math.ceil(t/8)}function Cn(r){let t=Ts(r);return t+Math.ceil(t/2)}function Ls(r,t,e=!1){let n=r.length,o=Ts(t),s=Cn(t);if(n<16||n<s||n>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+n);let i=e?te(r):qt(r),a=z(i,t-Y)+Y;return e?le(a,o):ee(a,o)}var Ps=BigInt(0),yr=BigInt(1);function Dn(r,t){let e=t.negate();return r?e:t}function Cs(r,t){if(!Number.isSafeInteger(r)||r<=0||r>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+r)}function Un(r,t){Cs(r,t);let e=Math.ceil(t/r)+1,n=2**(r-1);return{windows:e,windowSize:n}}function nu(r,t){if(!Array.isArray(r))throw new Error("array expected");r.forEach((e,n)=>{if(!(e instanceof t))throw new Error("invalid point at index "+n)})}function ou(r,t){if(!Array.isArray(r))throw new Error("array of scalars expected");r.forEach((e,n)=>{if(!t.isValid(e))throw new Error("invalid scalar at index "+n)})}var _n=new WeakMap,Ds=new WeakMap;function Kn(r){return Ds.get(r)||1}function gr(r,t){return{constTimeNegate:Dn,hasPrecomputes(e){return Kn(e)!==1},unsafeLadder(e,n,o=r.ZERO){let s=e;for(;n>Ps;)n&yr&&(o=o.add(s)),s=s.double(),n>>=yr;return o},precomputeWindow(e,n){let{windows:o,windowSize:s}=Un(n,t),i=[],a=e,c=a;for(let f=0;f<o;f++){c=a,i.push(c);for(let u=1;u<s;u++)c=c.add(a),i.push(c);a=c.double()}return i},wNAF(e,n,o){let{windows:s,windowSize:i}=Un(e,t),a=r.ZERO,c=r.BASE,f=BigInt(2**e-1),u=2**e,l=BigInt(e);for(let p=0;p<s;p++){let x=p*i,w=Number(o&f);o>>=l,w>i&&(w-=u,o+=yr);let g=x,h=x+Math.abs(w)-1,E=p%2!==0,A=w<0;w===0?c=c.add(Dn(E,n[g])):a=a.add(Dn(A,n[h]))}return{p:a,f:c}},wNAFUnsafe(e,n,o,s=r.ZERO){let{windows:i,windowSize:a}=Un(e,t),c=BigInt(2**e-1),f=2**e,u=BigInt(e);for(let l=0;l<i;l++){let p=l*a;if(o===Ps)break;let x=Number(o&c);if(o>>=u,x>a&&(x-=f,o+=yr),x===0)continue;let w=n[p+Math.abs(x)-1];x<0&&(w=w.negate()),s=s.add(w)}return s},getPrecomputes(e,n,o){let s=_n.get(n);return s||(s=this.precomputeWindow(n,e),e!==1&&_n.set(n,o(s))),s},wNAFCached(e,n,o){let s=Kn(e);return this.wNAF(s,this.getPrecomputes(s,e,o),n)},wNAFCachedUnsafe(e,n,o,s){let i=Kn(e);return i===1?this.unsafeLadder(e,n,s):this.wNAFUnsafe(i,this.getPrecomputes(i,e,o),n,s)},setWindowSize(e,n){Cs(n,t),Ds.set(e,n),_n.delete(e)}}}function br(r,t,e,n){if(nu(e,r),ou(n,t),e.length!==n.length)throw new Error("arrays of points and scalars must have equal length");let o=r.ZERO,s=Bn(BigInt(e.length)),i=s>12?s-3:s>4?s-2:s?2:1,a=(1<<i)-1,c=new Array(a+1).fill(o),f=Math.floor((t.BITS-1)/i)*i,u=o;for(let l=f;l>=0;l-=i){c.fill(o);for(let x=0;x<n.length;x++){let w=n[x],g=Number(w>>BigInt(l)&BigInt(a));c[g]=c[g].add(e[x])}let p=o;for(let x=c.length-1,w=o;x>0;x--)w=w.add(c[x]),p=p.add(w);if(u=u.add(p),l!==0)for(let x=0;x<i;x++)u=u.double()}return u}function Ze(r){return Ln(r.Fp),Dt(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Pn(r.n,r.nBitLength),...r,p:r.Fp.ORDER})}var Lt=BigInt(0),wt=BigInt(1),xr=BigInt(2),su=BigInt(8),iu={zip215:!0};function au(r){let t=Ze(r);return Dt(r,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}function Us(r){let t=au(r),{Fp:e,n,prehash:o,hash:s,randomBytes:i,nByteLength:a,h:c}=t,f=xr<<BigInt(a*8)-wt,u=e.create,l=re(t.n,t.nBitLength),p=t.uvRatio||((y,d)=>{try{return{isValid:!0,value:e.sqrt(y*e.inv(d))}}catch{return{isValid:!1,value:Lt}}}),x=t.adjustScalarBytes||(y=>y),w=t.domain||((y,d,b)=>{if(Tt("phflag",b),d.length||b)throw new Error("Contexts/pre-hash are not supported");return y});function g(y,d){xt("coordinate "+y,d,Lt,f)}function h(y){if(!(y instanceof m))throw new Error("ExtendedPoint expected")}let E=he((y,d)=>{let{ex:b,ey:v,ez:U}=y,_=y.is0();d==null&&(d=_?su:e.inv(U));let N=u(b*d),M=u(v*d),K=u(U*d);if(_)return{x:Lt,y:wt};if(K!==wt)throw new Error("invZ was invalid");return{x:N,y:M}}),A=he(y=>{let{a:d,d:b}=t;if(y.is0())throw new Error("bad point: ZERO");let{ex:v,ey:U,ez:_,et:N}=y,M=u(v*v),K=u(U*U),V=u(_*_),j=u(V*V),ot=u(M*d),st=u(V*u(ot+K)),ct=u(j+u(b*u(M*K)));if(st!==ct)throw new Error("bad point: equation left != right (1)");let ft=u(v*U),yt=u(_*N);if(ft!==yt)throw new Error("bad point: equation left != right (2)");return!0});class m{constructor(d,b,v,U){this.ex=d,this.ey=b,this.ez=v,this.et=U,g("x",d),g("y",b),g("z",v),g("t",U),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(d){if(d instanceof m)throw new Error("extended point not allowed");let{x:b,y:v}=d||{};return g("x",b),g("y",v),new m(b,v,wt,u(b*v))}static normalizeZ(d){let b=e.invertBatch(d.map(v=>v.ez));return d.map((v,U)=>v.toAffine(b[U])).map(m.fromAffine)}static msm(d,b){return br(m,l,d,b)}_setWindowSize(d){C.setWindowSize(this,d)}assertValidity(){A(this)}equals(d){h(d);let{ex:b,ey:v,ez:U}=this,{ex:_,ey:N,ez:M}=d,K=u(b*M),V=u(_*U),j=u(v*M),ot=u(N*U);return K===V&&j===ot}is0(){return this.equals(m.ZERO)}negate(){return new m(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){let{a:d}=t,{ex:b,ey:v,ez:U}=this,_=u(b*b),N=u(v*v),M=u(xr*u(U*U)),K=u(d*_),V=b+v,j=u(u(V*V)-_-N),ot=K+N,st=ot-M,ct=K-N,ft=u(j*st),yt=u(ot*ct),dt=u(j*ct),Ct=u(st*ot);return new m(ft,yt,Ct,dt)}add(d){h(d);let{a:b,d:v}=t,{ex:U,ey:_,ez:N,et:M}=this,{ex:K,ey:V,ez:j,et:ot}=d;if(b===BigInt(-1)){let Ro=u((_-U)*(V+K)),No=u((_+U)*(V-K)),Vr=u(No-Ro);if(Vr===Lt)return this.double();let ko=u(N*xr*ot),Oo=u(M*xr*j),Mo=Oo+ko,qo=No+Ro,Ho=Oo-ko,Oi=u(Mo*Vr),Mi=u(qo*Ho),qi=u(Mo*Ho),Hi=u(Vr*qo);return new m(Oi,Mi,Hi,qi)}let st=u(U*K),ct=u(_*V),ft=u(M*v*ot),yt=u(N*j),dt=u((U+_)*(K+V)-st-ct),Ct=yt-ft,Kt=yt+ft,Re=u(ct-b*st),Ki=u(dt*Ct),Ri=u(Kt*Re),Ni=u(dt*Re),ki=u(Ct*Kt);return new m(Ki,Ri,ki,Ni)}subtract(d){return this.add(d.negate())}wNAF(d){return C.wNAFCached(this,d,m.normalizeZ)}multiply(d){let b=d;xt("scalar",b,wt,n);let{p:v,f:U}=this.wNAF(b);return m.normalizeZ([v,U])[0]}multiplyUnsafe(d,b=m.ZERO){let v=d;return xt("scalar",v,Lt,n),v===Lt?D:this.is0()||v===wt?this:C.wNAFCachedUnsafe(this,v,m.normalizeZ,b)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return C.unsafeLadder(this,n).is0()}toAffine(d){return E(this,d)}clearCofactor(){let{h:d}=t;return d===wt?this:this.multiplyUnsafe(d)}static fromHex(d,b=!1){let{d:v,a:U}=t,_=e.BYTES;d=X("pointHex",d,_),Tt("zip215",b);let N=d.slice(),M=d[_-1];N[_-1]=M&-129;let K=te(N),V=b?f:e.ORDER;xt("pointHex.y",K,Lt,V);let j=u(K*K),ot=u(j-wt),st=u(v*j-U),{isValid:ct,value:ft}=p(ot,st);if(!ct)throw new Error("Point.fromHex: invalid y coordinate");let yt=(ft&wt)===wt,dt=(M&128)!==0;if(!b&&ft===Lt&&dt)throw new Error("Point.fromHex: x=0 and x_0=1");return dt!==yt&&(ft=u(-ft)),m.fromAffine({x:ft,y:K})}static fromPrivateKey(d){return T(d).point}toRawBytes(){let{x:d,y:b}=this.toAffine(),v=le(b,e.BYTES);return v[v.length-1]|=d&wt?128:0,v}toHex(){return Mt(this.toRawBytes())}}m.BASE=new m(t.Gx,t.Gy,wt,u(t.Gx*t.Gy)),m.ZERO=new m(Lt,wt,wt,Lt);let{BASE:B,ZERO:D}=m,C=gr(m,a*8);function I(y){return z(y,n)}function P(y){return I(te(y))}function T(y){let d=e.BYTES;y=X("private key",y,d);let b=X("hashed private key",s(y),2*d),v=x(b.slice(0,d)),U=b.slice(d,2*d),_=P(v),N=B.multiply(_),M=N.toRawBytes();return{head:v,prefix:U,scalar:_,point:N,pointBytes:M}}function $(y){return T(y).pointBytes}function q(y=new Uint8Array,...d){let b=Ht(...d);return P(s(w(b,X("context",y),!!o)))}function O(y,d,b={}){y=X("message",y),o&&(y=o(y));let{prefix:v,scalar:U,pointBytes:_}=T(d),N=q(b.context,v,y),M=B.multiply(N).toRawBytes(),K=q(b.context,M,_,y),V=I(N+K*U);xt("signature.s",V,Lt,n);let j=Ht(M,le(V,e.BYTES));return X("result",j,e.BYTES*2)}let et=iu;function S(y,d,b,v=et){let{context:U,zip215:_}=v,N=e.BYTES;y=X("signature",y,2*N),d=X("message",d),b=X("publicKey",b,N),_!==void 0&&Tt("zip215",_),o&&(d=o(d));let M=te(y.slice(N,2*N)),K,V,j;try{K=m.fromHex(b,_),V=m.fromHex(y.slice(0,N),_),j=B.multiplyUnsafe(M)}catch{return!1}if(!_&&K.isSmallOrder())return!1;let ot=q(U,V.toRawBytes(),K.toRawBytes(),d);return V.add(K.multiplyUnsafe(ot)).subtract(j).clearCofactor().equals(m.ZERO)}return B._setWindowSize(8),{CURVE:t,getPublicKey:$,sign:O,verify:S,ExtendedPoint:m,utils:{getExtendedPublicKey:T,randomPrivateKey:()=>i(e.BYTES),precompute(y=8,d=m.BASE){return d._setWindowSize(y),d.multiply(BigInt(3)),d}}}}var Rn=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),_s=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),wh=BigInt(0),cu=BigInt(1),Ks=BigInt(2),Eh=BigInt(3),uu=BigInt(5),fu=BigInt(8);function lu(r){let t=BigInt(10),e=BigInt(20),n=BigInt(40),o=BigInt(80),s=Rn,a=r*r%s*r%s,c=W(a,Ks,s)*a%s,f=W(c,cu,s)*r%s,u=W(f,uu,s)*f%s,l=W(u,t,s)*u%s,p=W(l,e,s)*l%s,x=W(p,n,s)*p%s,w=W(x,o,s)*x%s,g=W(w,o,s)*x%s,h=W(g,t,s)*u%s;return{pow_p_5_8:W(h,Ks,s)*r%s,b2:a}}function hu(r){return r[0]&=248,r[31]&=127,r[31]|=64,r}function du(r,t){let e=Rn,n=z(t*t*t,e),o=z(n*n*t,e),s=lu(r*o).pow_p_5_8,i=z(r*n*s,e),a=z(t*i*i,e),c=i,f=z(i*_s,e),u=a===r,l=a===z(-r,e),p=a===z(-r*_s,e);return u&&(i=c),(l||p)&&(i=f),Is(i,e)&&(i=z(-i,e)),{isValid:u||l,value:i}}var pu=re(Rn,void 0,!0),mu={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:pu,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:fu,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:Es,randomBytes:fr,adjustScalarBytes:hu,uvRatio:du},Rs=Us(mu);var wr=32;function Ns(r,t,e){return Rs.verify(t,e instanceof Uint8Array?e:e.subarray(),r)}var Er=class{type="Ed25519";raw;constructor(t){this.raw=Nn(t,wr)}toMultihash(){return Bt.digest(Wt(this))}toCID(){return tt.createV1(114,this.toMultihash())}toString(){return Z.encode(this.toMultihash().bytes).substring(1)}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:it(this.raw,t.raw)}verify(t,e){return Ns(this.raw,e,t)}};function kn(r){return r=Nn(r,wr),new Er(r)}function Nn(r,t){if(r=Uint8Array.from(r??[]),r.length!==t)throw new rt(`Key must be a Uint8Array of length ${t}, got ${r.length}`);return r}var gu=Math.pow(2,7),bu=Math.pow(2,14),xu=Math.pow(2,21),On=Math.pow(2,28),Mn=Math.pow(2,35),qn=Math.pow(2,42),Hn=Math.pow(2,49),H=128,lt=127;function Et(r){if(r<gu)return 1;if(r<bu)return 2;if(r<xu)return 3;if(r<On)return 4;if(r<Mn)return 5;if(r<qn)return 6;if(r<Hn)return 7;if(Number.MAX_SAFE_INTEGER!=null&&r>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function Vn(r,t,e=0){switch(Et(r)){case 8:t[e++]=r&255|H,r/=128;case 7:t[e++]=r&255|H,r/=128;case 6:t[e++]=r&255|H,r/=128;case 5:t[e++]=r&255|H,r/=128;case 4:t[e++]=r&255|H,r>>>=7;case 3:t[e++]=r&255|H,r>>>=7;case 2:t[e++]=r&255|H,r>>>=7;case 1:{t[e++]=r&255,r>>>=7;break}default:throw new Error("unreachable")}return t}function wu(r,t,e=0){switch(Et(r)){case 8:t.set(e++,r&255|H),r/=128;case 7:t.set(e++,r&255|H),r/=128;case 6:t.set(e++,r&255|H),r/=128;case 5:t.set(e++,r&255|H),r/=128;case 4:t.set(e++,r&255|H),r>>>=7;case 3:t.set(e++,r&255|H),r>>>=7;case 2:t.set(e++,r&255|H),r>>>=7;case 1:{t.set(e++,r&255),r>>>=7;break}default:throw new Error("unreachable")}return t}function zn(r,t){let e=r[t],n=0;if(n+=e&lt,e<H||(e=r[t+1],n+=(e&lt)<<7,e<H)||(e=r[t+2],n+=(e&lt)<<14,e<H)||(e=r[t+3],n+=(e&lt)<<21,e<H)||(e=r[t+4],n+=(e&lt)*On,e<H)||(e=r[t+5],n+=(e&lt)*Mn,e<H)||(e=r[t+6],n+=(e&lt)*qn,e<H)||(e=r[t+7],n+=(e&lt)*Hn,e<H))return n;throw new RangeError("Could not decode varint")}function Eu(r,t){let e=r.get(t),n=0;if(n+=e&lt,e<H||(e=r.get(t+1),n+=(e&lt)<<7,e<H)||(e=r.get(t+2),n+=(e&lt)<<14,e<H)||(e=r.get(t+3),n+=(e&lt)<<21,e<H)||(e=r.get(t+4),n+=(e&lt)*On,e<H)||(e=r.get(t+5),n+=(e&lt)*Mn,e<H)||(e=r.get(t+6),n+=(e&lt)*qn,e<H)||(e=r.get(t+7),n+=(e&lt)*Hn,e<H))return n;throw new RangeError("Could not decode varint")}function Ut(r,t,e=0){return t==null&&(t=gt(Et(r))),t instanceof Uint8Array?Vn(r,t,e):wu(r,t,e)}function pe(r,t=0){return r instanceof Uint8Array?zn(r,t):Eu(r,t)}var Gn=new Float32Array([-0]),ne=new Uint8Array(Gn.buffer);function Os(r,t,e){Gn[0]=r,t[e]=ne[0],t[e+1]=ne[1],t[e+2]=ne[2],t[e+3]=ne[3]}function Ms(r,t){return ne[0]=r[t],ne[1]=r[t+1],ne[2]=r[t+2],ne[3]=r[t+3],Gn[0]}var jn=new Float64Array([-0]),ht=new Uint8Array(jn.buffer);function qs(r,t,e){jn[0]=r,t[e]=ht[0],t[e+1]=ht[1],t[e+2]=ht[2],t[e+3]=ht[3],t[e+4]=ht[4],t[e+5]=ht[5],t[e+6]=ht[6],t[e+7]=ht[7]}function Hs(r,t){return ht[0]=r[t],ht[1]=r[t+1],ht[2]=r[t+2],ht[3]=r[t+3],ht[4]=r[t+4],ht[5]=r[t+5],ht[6]=r[t+6],ht[7]=r[t+7],jn[0]}var Su=BigInt(Number.MAX_SAFE_INTEGER),Au=BigInt(Number.MIN_SAFE_INTEGER),At=class r{lo;hi;constructor(t,e){this.lo=t|0,this.hi=e|0}toNumber(t=!1){if(!t&&this.hi>>>31>0){let e=~this.lo+1>>>0,n=~this.hi>>>0;return e===0&&(n=n+1>>>0),-(e+n*4294967296)}return this.lo+this.hi*4294967296}toBigInt(t=!1){if(t)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){let e=~this.lo+1>>>0,n=~this.hi>>>0;return e===0&&(n=n+1>>>0),-(BigInt(e)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toString(t=!1){return this.toBigInt(t).toString()}zzEncode(){let t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this}zzDecode(){let t=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this}length(){let t=this.lo,e=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?e===0?t<16384?t<128?1:2:t<2097152?3:4:e<16384?e<128?5:6:e<2097152?7:8:n<128?9:10}static fromBigInt(t){if(t===0n)return me;if(t<Su&&t>Au)return this.fromNumber(Number(t));let e=t<0n;e&&(t=-t);let n=t>>32n,o=t-(n<<32n);return e&&(n=~n|0n,o=~o|0n,++o>Vs&&(o=0n,++n>Vs&&(n=0n))),new r(Number(o),Number(n))}static fromNumber(t){if(t===0)return me;let e=t<0;e&&(t=-t);let n=t>>>0,o=(t-n)/4294967296>>>0;return e&&(o=~o>>>0,n=~n>>>0,++n>4294967295&&(n=0,++o>4294967295&&(o=0))),new r(n,o)}static from(t){return typeof t=="number"?r.fromNumber(t):typeof t=="bigint"?r.fromBigInt(t):typeof t=="string"?r.fromBigInt(BigInt(t)):t.low!=null||t.high!=null?new r(t.low>>>0,t.high>>>0):me}},me=new At(0,0);me.toBigInt=function(){return 0n};me.zzEncode=me.zzDecode=function(){return this};me.length=function(){return 1};var Vs=4294967296n;function zs(r){let t=0,e=0;for(let n=0;n<r.length;++n)e=r.charCodeAt(n),e<128?t+=1:e<2048?t+=2:(e&64512)===55296&&(r.charCodeAt(n+1)&64512)===56320?(++n,t+=4):t+=3;return t}function Fs(r,t,e){if(e-t<1)return"";let o,s=[],i=0,a;for(;t<e;)a=r[t++],a<128?s[i++]=a:a>191&&a<224?s[i++]=(a&31)<<6|r[t++]&63:a>239&&a<365?(a=((a&7)<<18|(r[t++]&63)<<12|(r[t++]&63)<<6|r[t++]&63)-65536,s[i++]=55296+(a>>10),s[i++]=56320+(a&1023)):s[i++]=(a&15)<<12|(r[t++]&63)<<6|r[t++]&63,i>8191&&((o??(o=[])).push(String.fromCharCode.apply(String,s)),i=0);return o!=null?(i>0&&o.push(String.fromCharCode.apply(String,s.slice(0,i))),o.join("")):String.fromCharCode.apply(String,s.slice(0,i))}function Zn(r,t,e){let n=e,o,s;for(let i=0;i<r.length;++i)o=r.charCodeAt(i),o<128?t[e++]=o:o<2048?(t[e++]=o>>6|192,t[e++]=o&63|128):(o&64512)===55296&&((s=r.charCodeAt(i+1))&64512)===56320?(o=65536+((o&1023)<<10)+(s&1023),++i,t[e++]=o>>18|240,t[e++]=o>>12&63|128,t[e++]=o>>6&63|128,t[e++]=o&63|128):(t[e++]=o>>12|224,t[e++]=o>>6&63|128,t[e++]=o&63|128);return e-n}function Pt(r,t){return RangeError(`index out of range: ${r.pos} + ${t??1} > ${r.len}`)}function Sr(r,t){return(r[t-4]|r[t-3]<<8|r[t-2]<<16|r[t-1]<<24)>>>0}var $n=class{buf;pos;len;_slice=Uint8Array.prototype.subarray;constructor(t){this.buf=t,this.pos=0,this.len=t.length}uint32(){let t=4294967295;if(t=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(t=(t|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return t;if((this.pos+=5)>this.len)throw this.pos=this.len,Pt(this,10);return t}int32(){return this.uint32()|0}sint32(){let t=this.uint32();return t>>>1^-(t&1)|0}bool(){return this.uint32()!==0}fixed32(){if(this.pos+4>this.len)throw Pt(this,4);return Sr(this.buf,this.pos+=4)}sfixed32(){if(this.pos+4>this.len)throw Pt(this,4);return Sr(this.buf,this.pos+=4)|0}float(){if(this.pos+4>this.len)throw Pt(this,4);let t=Ms(this.buf,this.pos);return this.pos+=4,t}double(){if(this.pos+8>this.len)throw Pt(this,4);let t=Hs(this.buf,this.pos);return this.pos+=8,t}bytes(){let t=this.uint32(),e=this.pos,n=this.pos+t;if(n>this.len)throw Pt(this,t);return this.pos+=t,e===n?new Uint8Array(0):this.buf.subarray(e,n)}string(){let t=this.bytes();return Fs(t,0,t.length)}skip(t){if(typeof t=="number"){if(this.pos+t>this.len)throw Pt(this,t);this.pos+=t}else do if(this.pos>=this.len)throw Pt(this);while((this.buf[this.pos++]&128)!==0);return this}skipType(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error(`invalid wire type ${t} at offset ${this.pos}`)}return this}readLongVarint(){let t=new At(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw Pt(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw Pt(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}readFixed64(){if(this.pos+8>this.len)throw Pt(this,8);let t=Sr(this.buf,this.pos+=4),e=Sr(this.buf,this.pos+=4);return new At(t,e)}int64(){return this.readLongVarint().toBigInt()}int64Number(){return this.readLongVarint().toNumber()}int64String(){return this.readLongVarint().toString()}uint64(){return this.readLongVarint().toBigInt(!0)}uint64Number(){let t=zn(this.buf,this.pos);return this.pos+=Et(t),t}uint64String(){return this.readLongVarint().toString(!0)}sint64(){return this.readLongVarint().zzDecode().toBigInt()}sint64Number(){return this.readLongVarint().zzDecode().toNumber()}sint64String(){return this.readLongVarint().zzDecode().toString()}fixed64(){return this.readFixed64().toBigInt()}fixed64Number(){return this.readFixed64().toNumber()}fixed64String(){return this.readFixed64().toString()}sfixed64(){return this.readFixed64().toBigInt()}sfixed64Number(){return this.readFixed64().toNumber()}sfixed64String(){return this.readFixed64().toString()}};function Yn(r){return new $n(r instanceof Uint8Array?r:r.subarray())}function Vt(r,t,e){let n=Yn(r);return t.decode(n,void 0,e)}function Wn(r){let t=r??8192,e=t>>>1,n,o=t;return function(i){if(i<1||i>e)return gt(i);o+i>t&&(n=gt(t),o=0);let a=n.subarray(o,o+=i);return(o&7)!==0&&(o=(o|7)+1),a}}var ye=class{fn;len;next;val;constructor(t,e,n){this.fn=t,this.len=e,this.next=void 0,this.val=n}};function Xn(){}var Qn=class{head;tail;len;next;constructor(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}},vu=Wn();function Bu(r){return globalThis.Buffer!=null?gt(r):vu(r)}var Ye=class{len;head;tail;states;constructor(){this.len=0,this.head=new ye(Xn,0,0),this.tail=this.head,this.states=null}_push(t,e,n){return this.tail=this.tail.next=new ye(t,e,n),this.len+=e,this}uint32(t){return this.len+=(this.tail=this.tail.next=new to((t=t>>>0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this}int32(t){return t<0?this._push(Ar,10,At.fromNumber(t)):this.uint32(t)}sint32(t){return this.uint32((t<<1^t>>31)>>>0)}uint64(t){let e=At.fromBigInt(t);return this._push(Ar,e.length(),e)}uint64Number(t){return this._push(Vn,Et(t),t)}uint64String(t){return this.uint64(BigInt(t))}int64(t){return this.uint64(t)}int64Number(t){return this.uint64Number(t)}int64String(t){return this.uint64String(t)}sint64(t){let e=At.fromBigInt(t).zzEncode();return this._push(Ar,e.length(),e)}sint64Number(t){let e=At.fromNumber(t).zzEncode();return this._push(Ar,e.length(),e)}sint64String(t){return this.sint64(BigInt(t))}bool(t){return this._push(Jn,1,t?1:0)}fixed32(t){return this._push($e,4,t>>>0)}sfixed32(t){return this.fixed32(t)}fixed64(t){let e=At.fromBigInt(t);return this._push($e,4,e.lo)._push($e,4,e.hi)}fixed64Number(t){let e=At.fromNumber(t);return this._push($e,4,e.lo)._push($e,4,e.hi)}fixed64String(t){return this.fixed64(BigInt(t))}sfixed64(t){return this.fixed64(t)}sfixed64Number(t){return this.fixed64Number(t)}sfixed64String(t){return this.fixed64String(t)}float(t){return this._push(Os,4,t)}double(t){return this._push(qs,8,t)}bytes(t){let e=t.length>>>0;return e===0?this._push(Jn,1,0):this.uint32(e)._push(Tu,e,t)}string(t){let e=zs(t);return e!==0?this.uint32(e)._push(Zn,e,t):this._push(Jn,1,0)}fork(){return this.states=new Qn(this),this.head=this.tail=new ye(Xn,0,0),this.len=0,this}reset(){return this.states!=null?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new ye(Xn,0,0),this.len=0),this}ldelim(){let t=this.head,e=this.tail,n=this.len;return this.reset().uint32(n),n!==0&&(this.tail.next=t.next,this.tail=e,this.len+=n),this}finish(){let t=this.head.next,e=Bu(this.len),n=0;for(;t!=null;)t.fn(t.val,e,n),n+=t.len,t=t.next;return e}};function Jn(r,t,e){t[e]=r&255}function Iu(r,t,e){for(;r>127;)t[e++]=r&127|128,r>>>=7;t[e]=r}var to=class extends ye{next;constructor(t,e){super(Iu,t,e),this.next=void 0}};function Ar(r,t,e){for(;r.hi!==0;)t[e++]=r.lo&127|128,r.lo=(r.lo>>>7|r.hi<<25)>>>0,r.hi>>>=7;for(;r.lo>127;)t[e++]=r.lo&127|128,r.lo=r.lo>>>7;t[e++]=r.lo}function $e(r,t,e){t[e]=r&255,t[e+1]=r>>>8&255,t[e+2]=r>>>16&255,t[e+3]=r>>>24}function Tu(r,t,e){t.set(r,e)}globalThis.Buffer!=null&&(Ye.prototype.bytes=function(r){let t=r.length>>>0;return this.uint32(t),t>0&&this._push(Lu,t,r),this},Ye.prototype.string=function(r){let t=globalThis.Buffer.byteLength(r);return this.uint32(t),t>0&&this._push(Pu,t,r),this});function Lu(r,t,e){t.set(r,e)}function Pu(r,t,e){r.length<40?Zn(r,t,e):t.utf8Write!=null?t.utf8Write(r,e):t.set(F(r),e)}function eo(){return new Ye}function zt(r,t){let e=eo();return t.encode(r,e,{lengthDelimited:!1}),e.finish()}var Ce;(function(r){r[r.VARINT=0]="VARINT",r[r.BIT64=1]="BIT64",r[r.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",r[r.START_GROUP=3]="START_GROUP",r[r.END_GROUP=4]="END_GROUP",r[r.BIT32=5]="BIT32"})(Ce||(Ce={}));function vr(r,t,e,n){return{name:r,type:t,encode:e,decode:n}}function ro(r){function t(o){if(r[o.toString()]==null)throw new Error("Invalid enum value");return r[o]}let e=function(s,i){let a=t(s);i.int32(a)},n=function(s){let i=s.int32();return t(i)};return vr("enum",Ce.VARINT,e,n)}function Ft(r,t){return vr("message",Ce.LENGTH_DELIMITED,r,t)}var Br=class extends Error{code="ERR_MAX_LENGTH";name="MaxLengthError"};var Q;(function(r){r.RSA="RSA",r.Ed25519="Ed25519",r.secp256k1="secp256k1",r.ECDSA="ECDSA"})(Q||(Q={}));var no;(function(r){r[r.RSA=0]="RSA",r[r.Ed25519=1]="Ed25519",r[r.secp256k1=2]="secp256k1",r[r.ECDSA=3]="ECDSA"})(no||(no={}));(function(r){r.codec=()=>ro(no)})(Q||(Q={}));var _t;(function(r){let t;r.codec=()=>(t==null&&(t=Ft((e,n,o={})=>{o.lengthDelimited!==!1&&n.fork(),e.Type!=null&&(n.uint32(8),Q.codec().encode(e.Type,n)),e.Data!=null&&(n.uint32(18),n.bytes(e.Data)),o.lengthDelimited!==!1&&n.ldelim()},(e,n,o={})=>{let s={},i=n==null?e.len:e.pos+n;for(;e.pos<i;){let a=e.uint32();switch(a>>>3){case 1:{s.Type=Q.codec().decode(e);break}case 2:{s.Data=e.bytes();break}default:{e.skipType(a&7);break}}}return s})),t),r.encode=e=>zt(e,r.codec()),r.decode=(e,n)=>Vt(e,r.codec(),n)})(_t||(_t={}));var oo;(function(r){let t;r.codec=()=>(t==null&&(t=Ft((e,n,o={})=>{o.lengthDelimited!==!1&&n.fork(),e.Type!=null&&(n.uint32(8),Q.codec().encode(e.Type,n)),e.Data!=null&&(n.uint32(18),n.bytes(e.Data)),o.lengthDelimited!==!1&&n.ldelim()},(e,n,o={})=>{let s={},i=n==null?e.len:e.pos+n;for(;e.pos<i;){let a=e.uint32();switch(a>>>3){case 1:{s.Type=Q.codec().decode(e);break}case 2:{s.Data=e.bytes();break}default:{e.skipType(a&7);break}}}return s})),t),r.encode=e=>zt(e,r.codec()),r.decode=(e,n)=>Vt(e,r.codec(),n)})(oo||(oo={}));var We=class extends Error{constructor(t="An error occurred while verifying a message"){super(t),this.name="VerificationError"}},Ir=class extends Error{constructor(t="Missing Web Crypto API"){super(t),this.name="WebCryptoMissingError"}};var Zs={get(r=globalThis){let t=r.crypto;if(t?.subtle==null)throw new Ir("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p/blob/main/packages/crypto/README.md#web-crypto-api");return t}};var oe=Zs;var Je={};pt(Je,{MAX_RSA_KEY_SIZE:()=>io,generateRSAKeyPair:()=>Xs,jwkToJWKKeyPair:()=>Js,jwkToPkcs1:()=>Ku,jwkToPkix:()=>fo,jwkToRSAPrivateKey:()=>mo,pkcs1MessageToJwk:()=>co,pkcs1MessageToRSAPrivateKey:()=>lo,pkcs1ToJwk:()=>_u,pkcs1ToRSAPrivateKey:()=>Ws,pkixMessageToJwk:()=>uo,pkixMessageToRSAPublicKey:()=>po,pkixToJwk:()=>Ru,pkixToRSAPublicKey:()=>ho});var Cu=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),se=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ie=new Uint32Array(64),so=class extends Le{constructor(){super(64,32,8,!1),this.A=se[0]|0,this.B=se[1]|0,this.C=se[2]|0,this.D=se[3]|0,this.E=se[4]|0,this.F=se[5]|0,this.G=se[6]|0,this.H=se[7]|0}get(){let{A:t,B:e,C:n,D:o,E:s,F:i,G:a,H:c}=this;return[t,e,n,o,s,i,a,c]}set(t,e,n,o,s,i,a,c){this.A=t|0,this.B=e|0,this.C=n|0,this.D=o|0,this.E=s|0,this.F=i|0,this.G=a|0,this.H=c|0}process(t,e){for(let l=0;l<16;l++,e+=4)ie[l]=t.getUint32(e,!1);for(let l=16;l<64;l++){let p=ie[l-15],x=ie[l-2],w=It(p,7)^It(p,18)^p>>>3,g=It(x,17)^It(x,19)^x>>>10;ie[l]=g+ie[l-7]+w+ie[l-16]|0}let{A:n,B:o,C:s,D:i,E:a,F:c,G:f,H:u}=this;for(let l=0;l<64;l++){let p=It(a,6)^It(a,11)^It(a,25),x=u+p+bs(a,c,f)+Cu[l]+ie[l]|0,g=(It(n,2)^It(n,13)^It(n,22))+xs(n,o,s)|0;u=f,f=c,c=a,a=i+x|0,i=s,s=o,o=n,n=x+g|0}n=n+this.A|0,o=o+this.B|0,s=s+this.C|0,i=i+this.D|0,a=a+this.E|0,c=c+this.F|0,f=f+this.G|0,u=u+this.H|0,this.set(n,o,s,i,a,c,f,u)}roundClean(){ie.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var De=ur(()=>new so);var Ue=class{type="RSA";jwk;_raw;_multihash;constructor(t,e){this.jwk=t,this._multihash=e}get raw(){return this._raw==null&&(this._raw=Je.jwkToPkix(this.jwk)),this._raw}toMultihash(){return this._multihash}toCID(){return tt.createV1(114,this._multihash)}toString(){return Z.encode(this.toMultihash().bytes).substring(1)}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:it(this.raw,t.raw)}verify(t,e){return Ys(this.jwk,e,t)}},Xe=class{type="RSA";jwk;_raw;publicKey;constructor(t,e){this.jwk=t,this.publicKey=e}get raw(){return this._raw==null&&(this._raw=Je.jwkToPkcs1(this.jwk)),this._raw}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:it(this.raw,t.raw)}sign(t){return $s(this.jwk,t)}};var io=8192,ao=18,Du=1062,Uu=Uint8Array.from([48,13,6,9,42,134,72,134,247,13,1,1,1,5,0]);function _u(r){let t=kt(r);return co(t)}function co(r){return{n:k(r[1],"base64url"),e:k(r[2],"base64url"),d:k(r[3],"base64url"),p:k(r[4],"base64url"),q:k(r[5],"base64url"),dp:k(r[6],"base64url"),dq:k(r[7],"base64url"),qi:k(r[8],"base64url"),kty:"RSA"}}function Ku(r){if(r.n==null||r.e==null||r.d==null||r.p==null||r.q==null||r.dp==null||r.dq==null||r.qi==null)throw new rt("JWK was missing components");return Yt([bt(Uint8Array.from([0])),bt(F(r.n,"base64url")),bt(F(r.e,"base64url")),bt(F(r.d,"base64url")),bt(F(r.p,"base64url")),bt(F(r.q,"base64url")),bt(F(r.dp,"base64url")),bt(F(r.dq,"base64url")),bt(F(r.qi,"base64url"))]).subarray()}function Ru(r){let t=kt(r,{offset:0});return uo(t)}function uo(r){let t=kt(r[1],{offset:0});return{kty:"RSA",n:k(t[0],"base64url"),e:k(t[1],"base64url")}}function fo(r){if(r.n==null||r.e==null)throw new rt("JWK was missing components");return Yt([Uu,ar(Yt([bt(F(r.n,"base64url")),bt(F(r.e,"base64url"))]))]).subarray()}function Ws(r){let t=kt(r);return lo(t)}function lo(r){let t=co(r);return mo(t)}function ho(r,t){if(r.byteLength>=Du)throw new be("Key size is too large");let e=kt(r,{offset:0});return po(e,r,t)}function po(r,t,e){let n=uo(r);if(e==null){let o=De(_t.encode({Type:Q.RSA,Data:t}));e=vt(ao,o)}return new Ue(n,e)}function mo(r){if(ti(r)>io)throw new rt("Key size is too large");let t=Js(r),e=De(_t.encode({Type:Q.RSA,Data:fo(t.publicKey)})),n=vt(ao,e);return new Xe(t.privateKey,new Ue(t.publicKey,n))}async function Xs(r){if(r>io)throw new rt("Key size is too large");let t=await Qs(r),e=De(_t.encode({Type:Q.RSA,Data:fo(t.publicKey)})),n=vt(ao,e);return new Xe(t.privateKey,new Ue(t.publicKey,n))}function Js(r){if(r==null)throw new rt("Missing key parameter");return{privateKey:r,publicKey:{kty:r.kty,n:r.n,e:r.e}}}async function Qs(r){let t=await oe.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:r,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),e=await Nu(t);return{privateKey:e[0],publicKey:e[1]}}async function $s(r,t){let e=await oe.get().subtle.importKey("jwk",r,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await oe.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},e,t instanceof Uint8Array?t:t.subarray());return new Uint8Array(n,0,n.byteLength)}async function Ys(r,t,e){let n=await oe.get().subtle.importKey("jwk",r,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return oe.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,t,e instanceof Uint8Array?e:e.subarray())}async function Nu(r){if(r.privateKey==null||r.publicKey==null)throw new rt("Private and public key are required");return Promise.all([oe.get().subtle.exportKey("jwk",r.privateKey),oe.get().subtle.exportKey("jwk",r.publicKey)])}function ti(r){if(r.kty!=="RSA")throw new rt("invalid key type");if(r.n==null)throw new rt("invalid key modulus");return F(r.n,"base64url").length*8}var Tr=class extends Te{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,ms(t);let n=Fe(e);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let o=this.blockLen,s=new Uint8Array(o);s.set(n.length>o?t.create().update(n).digest():n);for(let i=0;i<s.length;i++)s[i]^=54;this.iHash.update(s),this.oHash=t.create();for(let i=0;i<s.length;i++)s[i]^=106;this.oHash.update(s),s.fill(0)}update(t){return Ie(this),this.iHash.update(t),this}digestInto(t){Ie(this),Be(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:e,iHash:n,finished:o,destroyed:s,blockLen:i,outputLen:a}=this;return t=t,t.finished=o,t.destroyed=s,t.blockLen=i,t.outputLen=a,t.oHash=e._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},yo=(r,t,e)=>new Tr(r,t).update(e).digest();yo.create=(r,t)=>new Tr(r,t);function ei(r){r.lowS!==void 0&&Tt("lowS",r.lowS),r.prehash!==void 0&&Tt("prehash",r.prehash)}function ku(r){let t=Ze(r);Dt(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:e,Fp:n,a:o}=t;if(e){if(!n.eql(o,n.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if(typeof e!="object"||typeof e.beta!="bigint"||typeof e.splitScalar!="function")throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...t})}var{bytesToNumberBE:Ou,hexToBytes:Mu}=pr,go=class extends Error{constructor(t=""){super(t)}},Gt={Err:go,_tlv:{encode:(r,t)=>{let{Err:e}=Gt;if(r<0||r>256)throw new e("tlv.encode: wrong tag");if(t.length&1)throw new e("tlv.encode: unpadded data");let n=t.length/2,o=ue(n);if(o.length/2&128)throw new e("tlv.encode: long form length too big");let s=n>127?ue(o.length/2|128):"";return ue(r)+s+o+t},decode(r,t){let{Err:e}=Gt,n=0;if(r<0||r>256)throw new e("tlv.encode: wrong tag");if(t.length<2||t[n++]!==r)throw new e("tlv.decode: wrong tlv");let o=t[n++],s=!!(o&128),i=0;if(!s)i=o;else{let c=o&127;if(!c)throw new e("tlv.decode(long): indefinite length not supported");if(c>4)throw new e("tlv.decode(long): byte length is too big");let f=t.subarray(n,n+c);if(f.length!==c)throw new e("tlv.decode: length bytes not complete");if(f[0]===0)throw new e("tlv.decode(long): zero leftmost byte");for(let u of f)i=i<<8|u;if(n+=c,i<128)throw new e("tlv.decode(long): not minimal encoding")}let a=t.subarray(n,n+i);if(a.length!==i)throw new e("tlv.decode: wrong value length");return{v:a,l:t.subarray(n+i)}}},_int:{encode(r){let{Err:t}=Gt;if(r<jt)throw new t("integer: negative integers are not allowed");let e=ue(r);if(Number.parseInt(e[0],16)&8&&(e="00"+e),e.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return e},decode(r){let{Err:t}=Gt;if(r[0]&128)throw new t("invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return Ou(r)}},toSig(r){let{Err:t,_int:e,_tlv:n}=Gt,o=typeof r=="string"?Mu(r):r;Pe(o);let{v:s,l:i}=n.decode(48,o);if(i.length)throw new t("invalid signature: left bytes after parsing");let{v:a,l:c}=n.decode(2,s),{v:f,l:u}=n.decode(2,c);if(u.length)throw new t("invalid signature: left bytes after parsing");return{r:e.decode(a),s:e.decode(f)}},hexFromSig(r){let{_tlv:t,_int:e}=Gt,n=t.encode(2,e.encode(r.r)),o=t.encode(2,e.encode(r.s)),s=n+o;return t.encode(48,s)}},jt=BigInt(0),at=BigInt(1),Wd=BigInt(2),ri=BigInt(3),Xd=BigInt(4);function qu(r){let t=ku(r),{Fp:e}=t,n=re(t.n,t.nBitLength),o=t.toBytes||((g,h,E)=>{let A=h.toAffine();return Ht(Uint8Array.from([4]),e.toBytes(A.x),e.toBytes(A.y))}),s=t.fromBytes||(g=>{let h=g.subarray(1),E=e.fromBytes(h.subarray(0,e.BYTES)),A=e.fromBytes(h.subarray(e.BYTES,2*e.BYTES));return{x:E,y:A}});function i(g){let{a:h,b:E}=t,A=e.sqr(g),m=e.mul(A,g);return e.add(e.add(m,e.mul(g,h)),E)}if(!e.eql(e.sqr(t.Gy),i(t.Gx)))throw new Error("bad generator point: equation left != right");function a(g){return Ge(g,at,t.n)}function c(g){let{allowedPrivateKeyLengths:h,nByteLength:E,wrapPrivateKey:A,n:m}=t;if(h&&typeof g!="bigint"){if(Qt(g)&&(g=Mt(g)),typeof g!="string"||!h.includes(g.length))throw new Error("invalid private key");g=g.padStart(E*2,"0")}let B;try{B=typeof g=="bigint"?g:qt(X("private key",g,E))}catch{throw new Error("invalid private key, expected hex or "+E+" bytes, got "+typeof g)}return A&&(B=z(B,m)),xt("private key",B,at,m),B}function f(g){if(!(g instanceof p))throw new Error("ProjectivePoint expected")}let u=he((g,h)=>{let{px:E,py:A,pz:m}=g;if(e.eql(m,e.ONE))return{x:E,y:A};let B=g.is0();h==null&&(h=B?e.ONE:e.inv(m));let D=e.mul(E,h),C=e.mul(A,h),I=e.mul(m,h);if(B)return{x:e.ZERO,y:e.ZERO};if(!e.eql(I,e.ONE))throw new Error("invZ was invalid");return{x:D,y:C}}),l=he(g=>{if(g.is0()){if(t.allowInfinityPoint&&!e.is0(g.py))return;throw new Error("bad point: ZERO")}let{x:h,y:E}=g.toAffine();if(!e.isValid(h)||!e.isValid(E))throw new Error("bad point: x or y not FE");let A=e.sqr(E),m=i(h);if(!e.eql(A,m))throw new Error("bad point: equation left != right");if(!g.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class p{constructor(h,E,A){if(this.px=h,this.py=E,this.pz=A,h==null||!e.isValid(h))throw new Error("x required");if(E==null||!e.isValid(E))throw new Error("y required");if(A==null||!e.isValid(A))throw new Error("z required");Object.freeze(this)}static fromAffine(h){let{x:E,y:A}=h||{};if(!h||!e.isValid(E)||!e.isValid(A))throw new Error("invalid affine point");if(h instanceof p)throw new Error("projective point not allowed");let m=B=>e.eql(B,e.ZERO);return m(E)&&m(A)?p.ZERO:new p(E,A,e.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(h){let E=e.invertBatch(h.map(A=>A.pz));return h.map((A,m)=>A.toAffine(E[m])).map(p.fromAffine)}static fromHex(h){let E=p.fromAffine(s(X("pointHex",h)));return E.assertValidity(),E}static fromPrivateKey(h){return p.BASE.multiply(c(h))}static msm(h,E){return br(p,n,h,E)}_setWindowSize(h){w.setWindowSize(this,h)}assertValidity(){l(this)}hasEvenY(){let{y:h}=this.toAffine();if(e.isOdd)return!e.isOdd(h);throw new Error("Field doesn't support isOdd")}equals(h){f(h);let{px:E,py:A,pz:m}=this,{px:B,py:D,pz:C}=h,I=e.eql(e.mul(E,C),e.mul(B,m)),P=e.eql(e.mul(A,C),e.mul(D,m));return I&&P}negate(){return new p(this.px,e.neg(this.py),this.pz)}double(){let{a:h,b:E}=t,A=e.mul(E,ri),{px:m,py:B,pz:D}=this,C=e.ZERO,I=e.ZERO,P=e.ZERO,T=e.mul(m,m),$=e.mul(B,B),q=e.mul(D,D),O=e.mul(m,B);return O=e.add(O,O),P=e.mul(m,D),P=e.add(P,P),C=e.mul(h,P),I=e.mul(A,q),I=e.add(C,I),C=e.sub($,I),I=e.add($,I),I=e.mul(C,I),C=e.mul(O,C),P=e.mul(A,P),q=e.mul(h,q),O=e.sub(T,q),O=e.mul(h,O),O=e.add(O,P),P=e.add(T,T),T=e.add(P,T),T=e.add(T,q),T=e.mul(T,O),I=e.add(I,T),q=e.mul(B,D),q=e.add(q,q),T=e.mul(q,O),C=e.sub(C,T),P=e.mul(q,$),P=e.add(P,P),P=e.add(P,P),new p(C,I,P)}add(h){f(h);let{px:E,py:A,pz:m}=this,{px:B,py:D,pz:C}=h,I=e.ZERO,P=e.ZERO,T=e.ZERO,$=t.a,q=e.mul(t.b,ri),O=e.mul(E,B),et=e.mul(A,D),S=e.mul(m,C),L=e.add(E,A),y=e.add(B,D);L=e.mul(L,y),y=e.add(O,et),L=e.sub(L,y),y=e.add(E,m);let d=e.add(B,C);return y=e.mul(y,d),d=e.add(O,S),y=e.sub(y,d),d=e.add(A,m),I=e.add(D,C),d=e.mul(d,I),I=e.add(et,S),d=e.sub(d,I),T=e.mul($,y),I=e.mul(q,S),T=e.add(I,T),I=e.sub(et,T),T=e.add(et,T),P=e.mul(I,T),et=e.add(O,O),et=e.add(et,O),S=e.mul($,S),y=e.mul(q,y),et=e.add(et,S),S=e.sub(O,S),S=e.mul($,S),y=e.add(y,S),O=e.mul(et,y),P=e.add(P,O),O=e.mul(d,y),I=e.mul(L,I),I=e.sub(I,O),O=e.mul(L,et),T=e.mul(d,T),T=e.add(T,O),new p(I,P,T)}subtract(h){return this.add(h.negate())}is0(){return this.equals(p.ZERO)}wNAF(h){return w.wNAFCached(this,h,p.normalizeZ)}multiplyUnsafe(h){let{endo:E,n:A}=t;xt("scalar",h,jt,A);let m=p.ZERO;if(h===jt)return m;if(this.is0()||h===at)return this;if(!E||w.hasPrecomputes(this))return w.wNAFCachedUnsafe(this,h,p.normalizeZ);let{k1neg:B,k1:D,k2neg:C,k2:I}=E.splitScalar(h),P=m,T=m,$=this;for(;D>jt||I>jt;)D&at&&(P=P.add($)),I&at&&(T=T.add($)),$=$.double(),D>>=at,I>>=at;return B&&(P=P.negate()),C&&(T=T.negate()),T=new p(e.mul(T.px,E.beta),T.py,T.pz),P.add(T)}multiply(h){let{endo:E,n:A}=t;xt("scalar",h,at,A);let m,B;if(E){let{k1neg:D,k1:C,k2neg:I,k2:P}=E.splitScalar(h),{p:T,f:$}=this.wNAF(C),{p:q,f:O}=this.wNAF(P);T=w.constTimeNegate(D,T),q=w.constTimeNegate(I,q),q=new p(e.mul(q.px,E.beta),q.py,q.pz),m=T.add(q),B=$.add(O)}else{let{p:D,f:C}=this.wNAF(h);m=D,B=C}return p.normalizeZ([m,B])[0]}multiplyAndAddUnsafe(h,E,A){let m=p.BASE,B=(C,I)=>I===jt||I===at||!C.equals(m)?C.multiplyUnsafe(I):C.multiply(I),D=B(this,E).add(B(h,A));return D.is0()?void 0:D}toAffine(h){return u(this,h)}isTorsionFree(){let{h,isTorsionFree:E}=t;if(h===at)return!0;if(E)return E(p,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h,clearCofactor:E}=t;return h===at?this:E?E(p,this):this.multiplyUnsafe(t.h)}toRawBytes(h=!0){return Tt("isCompressed",h),this.assertValidity(),o(p,this,h)}toHex(h=!0){return Tt("isCompressed",h),Mt(this.toRawBytes(h))}}p.BASE=new p(t.Gx,t.Gy,e.ONE),p.ZERO=new p(e.ZERO,e.ONE,e.ZERO);let x=t.nBitLength,w=gr(p,t.endo?Math.ceil(x/2):x);return{CURVE:t,ProjectivePoint:p,normPrivateKeyToScalar:c,weierstrassEquation:i,isWithinCurveOrder:a}}function Hu(r){let t=Ze(r);return Dt(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function ni(r){let t=Hu(r),{Fp:e,n}=t,o=e.BYTES+1,s=2*e.BYTES+1;function i(S){return z(S,n)}function a(S){return mr(S,n)}let{ProjectivePoint:c,normPrivateKeyToScalar:f,weierstrassEquation:u,isWithinCurveOrder:l}=qu({...t,toBytes(S,L,y){let d=L.toAffine(),b=e.toBytes(d.x),v=Ht;return Tt("isCompressed",y),y?v(Uint8Array.from([L.hasEvenY()?2:3]),b):v(Uint8Array.from([4]),b,e.toBytes(d.y))},fromBytes(S){let L=S.length,y=S[0],d=S.subarray(1);if(L===o&&(y===2||y===3)){let b=qt(d);if(!Ge(b,at,e.ORDER))throw new Error("Point is not on curve");let v=u(b),U;try{U=e.sqrt(v)}catch(M){let K=M instanceof Error?": "+M.message:"";throw new Error("Point is not on curve"+K)}let _=(U&at)===at;return(y&1)===1!==_&&(U=e.neg(U)),{x:b,y:U}}else if(L===s&&y===4){let b=e.fromBytes(d.subarray(0,e.BYTES)),v=e.fromBytes(d.subarray(e.BYTES,2*e.BYTES));return{x:b,y:v}}else{let b=o,v=s;throw new Error("invalid Point, expected length of "+b+", or uncompressed "+v+", got "+L)}}}),p=S=>Mt(ee(S,t.nByteLength));function x(S){let L=n>>at;return S>L}function w(S){return x(S)?i(-S):S}let g=(S,L,y)=>qt(S.slice(L,y));class h{constructor(L,y,d){this.r=L,this.s=y,this.recovery=d,this.assertValidity()}static fromCompact(L){let y=t.nByteLength;return L=X("compactSignature",L,y*2),new h(g(L,0,y),g(L,y,2*y))}static fromDER(L){let{r:y,s:d}=Gt.toSig(X("DER",L));return new h(y,d)}assertValidity(){xt("r",this.r,at,n),xt("s",this.s,at,n)}addRecoveryBit(L){return new h(this.r,this.s,L)}recoverPublicKey(L){let{r:y,s:d,recovery:b}=this,v=C(X("msgHash",L));if(b==null||![0,1,2,3].includes(b))throw new Error("recovery id invalid");let U=b===2||b===3?y+t.n:y;if(U>=e.ORDER)throw new Error("recovery id 2 or 3 invalid");let _=(b&1)===0?"02":"03",N=c.fromHex(_+p(U)),M=a(U),K=i(-v*M),V=i(d*M),j=c.BASE.multiplyAndAddUnsafe(N,K,V);if(!j)throw new Error("point at infinify");return j.assertValidity(),j}hasHighS(){return x(this.s)}normalizeS(){return this.hasHighS()?new h(this.r,i(-this.s),this.recovery):this}toDERRawBytes(){return fe(this.toDERHex())}toDERHex(){return Gt.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return fe(this.toCompactHex())}toCompactHex(){return p(this.r)+p(this.s)}}let E={isValidPrivateKey(S){try{return f(S),!0}catch{return!1}},normPrivateKeyToScalar:f,randomPrivateKey:()=>{let S=Cn(t.n);return Ls(t.randomBytes(S),t.n)},precompute(S=8,L=c.BASE){return L._setWindowSize(S),L.multiply(BigInt(3)),L}};function A(S,L=!0){return c.fromPrivateKey(S).toRawBytes(L)}function m(S){let L=Qt(S),y=typeof S=="string",d=(L||y)&&S.length;return L?d===o||d===s:y?d===2*o||d===2*s:S instanceof c}function B(S,L,y=!0){if(m(S))throw new Error("first arg must be private key");if(!m(L))throw new Error("second arg must be public key");return c.fromHex(L).multiply(f(S)).toRawBytes(y)}let D=t.bits2int||function(S){if(S.length>8192)throw new Error("input is too large");let L=qt(S),y=S.length*8-t.nBitLength;return y>0?L>>BigInt(y):L},C=t.bits2int_modN||function(S){return i(D(S))},I=je(t.nBitLength);function P(S){return xt("num < 2^"+t.nBitLength,S,jt,I),ee(S,t.nByteLength)}function T(S,L,y=$){if(["recovered","canonical"].some(st=>st in y))throw new Error("sign() legacy options not supported");let{hash:d,randomBytes:b}=t,{lowS:v,prehash:U,extraEntropy:_}=y;v==null&&(v=!0),S=X("msgHash",S),ei(y),U&&(S=X("prehashed msgHash",d(S)));let N=C(S),M=f(L),K=[P(M),P(N)];if(_!=null&&_!==!1){let st=_===!0?b(e.BYTES):_;K.push(X("extraEntropy",st))}let V=Ht(...K),j=N;function ot(st){let ct=D(st);if(!l(ct))return;let ft=a(ct),yt=c.BASE.multiply(ct).toAffine(),dt=i(yt.x);if(dt===jt)return;let Ct=i(ft*i(j+dt*M));if(Ct===jt)return;let Kt=(yt.x===dt?0:2)|Number(yt.y&at),Re=Ct;return v&&x(Ct)&&(Re=w(Ct),Kt^=1),new h(dt,Re,Kt)}return{seed:V,k2sig:ot}}let $={lowS:t.lowS,prehash:!1},q={lowS:t.lowS,prehash:!1};function O(S,L,y=$){let{seed:d,k2sig:b}=T(S,L,y),v=t;return In(v.hash.outputLen,v.nByteLength,v.hmac)(d,b)}c.BASE._setWindowSize(8);function et(S,L,y,d=q){let b=S;L=X("msgHash",L),y=X("publicKey",y);let{lowS:v,prehash:U,format:_}=d;if(ei(d),"strict"in d)throw new Error("options.strict was renamed to lowS");if(_!==void 0&&_!=="compact"&&_!=="der")throw new Error("format must be compact or der");let N=typeof b=="string"||Qt(b),M=!N&&!_&&typeof b=="object"&&b!==null&&typeof b.r=="bigint"&&typeof b.s=="bigint";if(!N&&!M)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let K,V;try{if(M&&(K=new h(b.r,b.s)),N){try{_!=="compact"&&(K=h.fromDER(b))}catch(Kt){if(!(Kt instanceof Gt.Err))throw Kt}!K&&_!=="der"&&(K=h.fromCompact(b))}V=c.fromHex(y)}catch{return!1}if(!K||v&&K.hasHighS())return!1;U&&(L=t.hash(L));let{r:j,s:ot}=K,st=C(L),ct=a(ot),ft=i(st*ct),yt=i(j*ct),dt=c.BASE.multiplyAndAddUnsafe(V,ft,yt)?.toAffine();return dt?i(dt.x)===j:!1}return{CURVE:t,getPublicKey:A,getSharedSecret:B,sign:O,verify:et,ProjectivePoint:c,Signature:h,utils:E}}function Vu(r){return{hash:r,hmac:(t,...e)=>yo(r,t,xn(...e)),randomBytes:fr}}function oi(r,t){let e=n=>ni({...r,...Vu(n)});return{...e(t),create:e}}var ai=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),si=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),zu=BigInt(1),bo=BigInt(2),ii=(r,t)=>(r+t/bo)/t;function Fu(r){let t=ai,e=BigInt(3),n=BigInt(6),o=BigInt(11),s=BigInt(22),i=BigInt(23),a=BigInt(44),c=BigInt(88),f=r*r*r%t,u=f*f*r%t,l=W(u,e,t)*u%t,p=W(l,e,t)*u%t,x=W(p,bo,t)*f%t,w=W(x,o,t)*x%t,g=W(w,s,t)*w%t,h=W(g,a,t)*g%t,E=W(h,c,t)*h%t,A=W(E,a,t)*g%t,m=W(A,e,t)*u%t,B=W(m,i,t)*w%t,D=W(B,n,t)*f%t,C=W(D,bo,t);if(!xo.eql(xo.sqr(C),r))throw new Error("Cannot find square root");return C}var xo=re(ai,void 0,void 0,{sqrt:Fu}),ge=oi({a:BigInt(0),b:BigInt(7),Fp:xo,n:si,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:r=>{let t=si,e=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-zu*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=e,i=BigInt("0x100000000000000000000000000000000"),a=ii(s*r,t),c=ii(-n*r,t),f=z(r-a*e-c*o,t),u=z(-a*n-c*s,t),l=f>i,p=u>i;if(l&&(f=t-f),p&&(u=t-u),f>i||u>i)throw new Error("splitScalar: Endomorphism failed, k="+r);return{k1neg:l,k1:f,k2neg:p,k2:u}}}},De),ip=BigInt(0);var ap=ge.ProjectivePoint;function ci(r){return r==null?!1:typeof r.then=="function"&&typeof r.catch=="function"&&typeof r.finally=="function"}function ui(r,t,e){let n=qe.digest(e instanceof Uint8Array?e:e.subarray());if(ci(n))return n.then(({digest:o})=>ge.verify(t,o,r)).catch(o=>{throw new We(String(o))});try{return ge.verify(t,n.digest,r)}catch(o){throw new We(String(o))}}var Lr=class{type="secp256k1";raw;_key;constructor(t){this._key=li(t),this.raw=fi(this._key)}toMultihash(){return Bt.digest(Wt(this))}toCID(){return tt.createV1(114,this.toMultihash())}toString(){return Z.encode(this.toMultihash().bytes).substring(1)}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:it(this.raw,t.raw)}verify(t,e){return ui(this._key,e,t)}};function wo(r){return new Lr(r)}function fi(r){return ge.ProjectivePoint.fromHex(r).toRawBytes(!0)}function li(r){try{return ge.ProjectivePoint.fromHex(r),r}catch(t){throw new be(String(t))}}function hi(r,t){let{Type:e,Data:n}=_t.decode(r),o=n??new Uint8Array;switch(e){case Q.RSA:return ho(o,t);case Q.Ed25519:return kn(o);case Q.secp256k1:return wo(o);case Q.ECDSA:return bn(o);default:throw new xe}}function di(r){let{Type:t,Data:e}=_t.decode(r.digest),n=e??new Uint8Array;switch(t){case Q.Ed25519:return kn(n);case Q.secp256k1:return wo(n);case Q.ECDSA:return bn(n);default:throw new xe}}function Wt(r){return _t.encode({Type:Q[r.type],Data:r.raw})}var Qe;(function(r){let t;r.codec=()=>(t==null&&(t=Ft((e,n,o={})=>{o.lengthDelimited!==!1&&n.fork(),e.publicKey!=null&&e.publicKey.byteLength>0&&(n.uint32(10),n.bytes(e.publicKey)),e.payloadType!=null&&e.payloadType.byteLength>0&&(n.uint32(18),n.bytes(e.payloadType)),e.payload!=null&&e.payload.byteLength>0&&(n.uint32(26),n.bytes(e.payload)),e.signature!=null&&e.signature.byteLength>0&&(n.uint32(42),n.bytes(e.signature)),o.lengthDelimited!==!1&&n.ldelim()},(e,n,o={})=>{let s={publicKey:ut(0),payloadType:ut(0),payload:ut(0),signature:ut(0)},i=n==null?e.len:e.pos+n;for(;e.pos<i;){let a=e.uint32();switch(a>>>3){case 1:{s.publicKey=e.bytes();break}case 2:{s.payloadType=e.bytes();break}case 3:{s.payload=e.bytes();break}case 5:{s.signature=e.bytes();break}default:{e.skipType(a&7);break}}}return s})),t),r.encode=e=>zt(e,r.codec()),r.decode=(e,n)=>Vt(e,r.codec(),n)})(Qe||(Qe={}));var Pr=class extends Error{constructor(t="Invalid signature"){super(t),this.name="InvalidSignatureError"}};var Cr=class r{static createFromProtobuf=async t=>{let e=Qe.decode(t),n=hi(e.publicKey);return new r({publicKey:n,payloadType:e.payloadType,payload:e.payload,signature:e.signature})};static seal=async(t,e)=>{if(e==null)throw new Error("Missing private key");let n=t.domain,o=t.codec,s=t.marshal(),i=pi(n,o,s),a=await e.sign(i.subarray());return new r({publicKey:e.publicKey,payloadType:o,payload:s,signature:a})};static openAndCertify=async(t,e)=>{let n=await r.createFromProtobuf(t);if(!await n.validate(e))throw new Pr("Envelope signature is not valid for the given domain");return n};publicKey;payloadType;payload;signature;marshaled;constructor(t){let{publicKey:e,payloadType:n,payload:o,signature:s}=t;this.publicKey=e,this.payloadType=n,this.payload=o,this.signature=s}marshal(){return this.marshaled==null&&(this.marshaled=Qe.encode({publicKey:Wt(this.publicKey),payloadType:this.payloadType,payload:this.payload.subarray(),signature:this.signature})),this.marshaled}equals(t){return it(this.marshal(),t.marshal())}async validate(t){let e=pi(t,this.payloadType,this.payload);return this.publicKey.verify(e.subarray(),this.signature)}},pi=(r,t,e)=>{let n=F(r),o=Ut(n.byteLength),s=Ut(t.length),i=Ut(e.length);return new mt(o,n,s,t,i,e)};var mi=Symbol.for("nodejs.util.inspect.custom"),Gu=114,tr=class{type;multihash;publicKey;string;constructor(t){this.type=t.type,this.multihash=t.multihash,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[Fr]=!0;toString(){return this.string==null&&(this.string=Z.encode(this.multihash.bytes).slice(1)),this.string}toMultihash(){return this.multihash}toCID(){return tt.createV1(Gu,this.multihash)}toJSON(){return this.toString()}equals(t){if(t==null)return!1;if(t instanceof Uint8Array)return it(this.multihash.bytes,t);if(typeof t=="string")return this.toString()===t;if(t?.toMultihash()?.bytes!=null)return it(this.multihash.bytes,t.toMultihash().bytes);throw new Error("not valid Id")}[mi](){return`PeerId(${this.toString()})`}},Dr=class extends tr{type="RSA";publicKey;constructor(t){super({...t,type:"RSA"}),this.publicKey=t.publicKey}},Ur=class extends tr{type="Ed25519";publicKey;constructor(t){super({...t,type:"Ed25519"}),this.publicKey=t.publicKey}},_r=class extends tr{type="secp256k1";publicKey;constructor(t){super({...t,type:"secp256k1"}),this.publicKey=t.publicKey}},ju=2336,Kr=class{type="url";multihash;publicKey;url;constructor(t){this.url=t.toString(),this.multihash=Bt.digest(F(this.url))}[mi](){return`PeerId(${this.url})`}[Fr]=!0;toString(){return this.toCID().toString()}toMultihash(){return this.multihash}toCID(){return tt.createV1(ju,this.toMultihash())}toJSON(){return this.toString()}equals(t){return t==null?!1:(t instanceof Uint8Array&&(t=k(t)),t.toString()===this.toString())}};function yi(r){if($u(r))return new Dr({multihash:r});if(Zu(r))try{let t=di(r);if(t.type==="Ed25519")return new Ur({multihash:r,publicKey:t});if(t.type==="secp256k1")return new _r({multihash:r,publicKey:t})}catch{let e=k(r.digest);return new Kr(new URL(e))}throw new nr("Supplied PeerID Multihash is invalid")}function Zu(r){return r.code===Bt.code}function $u(r){return r.code===qe.code}function gi(r,t){let e=(n,o)=>n.toString().localeCompare(o.toString());return r.length!==t.length?!1:(t.sort(e),r.sort(e).every((n,o)=>t[o].equals(n)))}var Rr=class{index=0;input="";new(t){return this.index=0,this.input=t,this}readAtomically(t){let e=this.index,n=t();return n===void 0&&(this.index=e),n}parseWith(t){let e=t();if(this.index===this.input.length)return e}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(t){return this.readAtomically(()=>{let e=this.readChar();if(e===t)return e})}readSeparator(t,e,n){return this.readAtomically(()=>{if(!(e>0&&this.readGivenChar(t)===void 0))return n()})}readNumber(t,e,n,o){return this.readAtomically(()=>{let s=0,i=0,a=this.peekChar();if(a===void 0)return;let c=a==="0",f=2**(8*o)-1;for(;;){let u=this.readAtomically(()=>{let l=this.readChar();if(l===void 0)return;let p=Number.parseInt(l,t);if(!Number.isNaN(p))return p});if(u===void 0)break;if(s*=t,s+=u,s>f||(i+=1,e!==void 0&&i>e))return}if(i!==0)return!n&&c&&i>1?void 0:s})}readIPv4Addr(){return this.readAtomically(()=>{let t=new Uint8Array(4);for(let e=0;e<t.length;e++){let n=this.readSeparator(".",e,()=>this.readNumber(10,3,!1,1));if(n===void 0)return;t[e]=n}return t})}readIPv6Addr(){let t=e=>{for(let n=0;n<e.length/2;n++){let o=n*2;if(n<e.length-3){let i=this.readSeparator(":",n,()=>this.readIPv4Addr());if(i!==void 0)return e[o]=i[0],e[o+1]=i[1],e[o+2]=i[2],e[o+3]=i[3],[o+4,!0]}let s=this.readSeparator(":",n,()=>this.readNumber(16,4,!0,2));if(s===void 0)return[o,!1];e[o]=s>>8,e[o+1]=s&255}return[e.length,!1]};return this.readAtomically(()=>{let e=new Uint8Array(16),[n,o]=t(e);if(n===16)return e;if(o||this.readGivenChar(":")===void 0||this.readGivenChar(":")===void 0)return;let s=new Uint8Array(14),i=16-(n+2),[a]=t(s.subarray(0,i));return e.set(s.subarray(0,a),16-a),e})}readIPAddr(){return this.readIPv4Addr()??this.readIPv6Addr()}};var bi=45,Yu=15,_e=new Rr;function Eo(r){if(!(r.length>Yu))return _e.new(r).parseWith(()=>_e.readIPv4Addr())}function So(r){if(r.includes("%")&&(r=r.split("%")[0]),!(r.length>bi))return _e.new(r).parseWith(()=>_e.readIPv6Addr())}function Nr(r,t=!1){if(r.includes("%")&&(r=r.split("%")[0]),r.length>bi)return;let e=_e.new(r).parseWith(()=>_e.readIPAddr());if(e)return t&&e.length===4?Uint8Array.from([0,0,0,0,0,0,0,0,0,0,255,255,e[0],e[1],e[2],e[3]]):e}var K0=parseInt("0xFFFF",16),R0=new Uint8Array([0,0,0,0,0,0,0,0,0,0,255,255]);function Ei(r){return!!Eo(r)}function Si(r){return!!So(r)}function kr(r){return!!Nr(r)}var Ai=Ei,tf=Si,Ao=function(r){let t=0;if(r=r.toString().trim(),Ai(r)){let e=new Uint8Array(t+4);return r.split(/\./g).forEach(n=>{e[t++]=parseInt(n,10)&255}),e}if(tf(r)){let e=r.split(":",8),n;for(n=0;n<e.length;n++){let s=Ai(e[n]),i;s&&(i=Ao(e[n]),e[n]=k(i.slice(0,2),"base16")),i!=null&&++n<8&&e.splice(n,0,k(i.slice(2,4),"base16"))}if(e[0]==="")for(;e.length<8;)e.unshift("0");else if(e[e.length-1]==="")for(;e.length<8;)e.push("0");else if(e.length<8){for(n=0;n<e.length&&e[n]!=="";n++);let s=[n,1];for(n=9-e.length;n>0;n--)s.push("0");e.splice.apply(e,s)}let o=new Uint8Array(t+16);for(n=0;n<e.length;n++){let s=parseInt(e[n],16);o[t++]=s>>8&255,o[t++]=s&255}return o}throw new Error("invalid ip address")},vi=function(r,t=0,e){t=~~t,e=e??r.length-t;let n=new DataView(r.buffer);if(e===4){let o=[];for(let s=0;s<e;s++)o.push(r[t+s]);return o.join(".")}if(e===16){let o=[];for(let s=0;s<e;s+=2)o.push(n.getUint16(t+s).toString(16));return o.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var Ke={},vo={},rf=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[43,8,"ipcidr"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[448,0,"tls"],[449,-1,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,-1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[481,-1,"http-path"],[777,-1,"memory"]];rf.forEach(r=>{let t=nf(...r);vo[t.code]=t,Ke[t.name]=t});function nf(r,t,e,n,o){return{code:r,size:t,name:e,resolvable:!!n,path:!!o}}function G(r){if(typeof r=="number"){if(vo[r]!=null)return vo[r];throw new Error(`no protocol with code: ${r}`)}else if(typeof r=="string"){if(Ke[r]!=null)return Ke[r];throw new Error(`no protocol with name: ${r}`)}throw new Error(`invalid protocol id type: ${typeof r}`)}var bm=G("ip4"),xm=G("ip6"),wm=G("ipcidr");function Lo(r,t){switch(G(r).code){case 4:case 41:return sf(t);case 42:return To(t);case 43:return k(t,"base10");case 6:case 273:case 33:case 132:return Ti(t).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return To(t);case 421:return ff(t);case 444:return Ii(t);case 445:return Ii(t);case 466:return uf(t);case 481:return globalThis.encodeURIComponent(To(t));default:return k(t,"base16")}}function Po(r,t){switch(G(r).code){case 4:return Bi(t);case 41:return Bi(t);case 42:return Io(t);case 43:return F(t,"base10");case 6:case 273:case 33:case 132:return Co(parseInt(t,10));case 53:case 54:case 55:case 56:case 400:case 449:case 777:return Io(t);case 421:return af(t);case 444:return lf(t);case 445:return hf(t);case 466:return cf(t);case 481:return Io(globalThis.decodeURIComponent(t));default:return F(t,"base16")}}var Bo=Object.values(He).map(r=>r.decoder),of=function(){let r=Bo[0].or(Bo[1]);return Bo.slice(2).forEach(t=>r=r.or(t)),r}();function Bi(r){if(!kr(r))throw new Error("invalid ip address");return Ao(r)}function sf(r){let t=vi(r,0,r.length);if(t==null)throw new Error("ipBuff is required");if(!kr(t))throw new Error("invalid ip address");return t}function Co(r){let t=new ArrayBuffer(2);return new DataView(t).setUint16(0,r),new Uint8Array(t)}function Ti(r){return new DataView(r.buffer).getUint16(r.byteOffset)}function Io(r){let t=F(r),e=Uint8Array.from(Ut(t.length));return St([e,t],e.length+t.length)}function To(r){let t=pe(r);if(r=r.slice(Et(t)),r.length!==t)throw new Error("inconsistent lengths");return k(r)}function af(r){let t;r[0]==="Q"||r[0]==="1"?t=ae(Z.decode(`z${r}`)).bytes:t=tt.parse(r).multihash.bytes;let e=Uint8Array.from(Ut(t.length));return St([e,t],e.length+t.length)}function cf(r){let t=of.decode(r),e=Uint8Array.from(Ut(t.length));return St([e,t],e.length+t.length)}function uf(r){let t=pe(r),e=r.slice(Et(t));if(e.length!==t)throw new Error("inconsistent lengths");return"u"+k(e,"base64url")}function ff(r){let t=pe(r),e=r.slice(Et(t));if(e.length!==t)throw new Error("inconsistent lengths");return k(e,"base58btc")}function lf(r){let t=r.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==16)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion address.`);let e=Nt.decode("b"+t[0]),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=Co(n);return St([e,o],e.length+o.length)}function hf(r){let t=r.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==56)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion3 address.`);let e=Nt.decode(`b${t[0]}`),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=Co(n);return St([e,o],e.length+o.length)}function Ii(r){let t=r.slice(0,r.length-2),e=r.slice(r.length-2),n=k(t,"base32"),o=Ti(e);return`${n}:${o}`}function Li(r){r=Do(r);let t=[],e=[],n=null,o=r.split("/").slice(1);if(o.length===1&&o[0]==="")return{bytes:new Uint8Array,string:"/",tuples:[],stringTuples:[],path:null};for(let s=0;s<o.length;s++){let i=o[s],a=G(i);if(a.size===0){t.push([a.code]),e.push([a.code]);continue}if(s++,s>=o.length)throw new Or("invalid address: "+r);if(a.path===!0){n=Do(o.slice(s).join("/")),t.push([a.code,Po(a.code,n)]),e.push([a.code,n]);break}let c=Po(a.code,o[s]);t.push([a.code,c]),e.push([a.code,Lo(a.code,c)])}return{string:Pi(e),bytes:Mr(t),tuples:t,stringTuples:e,path:n}}function Uo(r){let t=[],e=[],n=null,o=0;for(;o<r.length;){let s=pe(r,o),i=Et(s),a=G(s),c=df(a,r.slice(o+i));if(c===0){t.push([s]),e.push([s]),o+=i;continue}let f=r.slice(o+i,o+i+c);if(o+=c+i,o>r.length)throw new Or("Invalid address Uint8Array: "+k(r,"base16"));t.push([s,f]);let u=Lo(s,f);if(e.push([s,u]),a.path===!0){n=u;break}}return{bytes:Uint8Array.from(r),string:Pi(e),tuples:t,stringTuples:e,path:n}}function Pi(r){let t=[];return r.map(e=>{let n=G(e[0]);return t.push(n.name),e.length>1&&e[1]!=null&&t.push(e[1]),null}),Do(t.join("/"))}function Mr(r){return St(r.map(t=>{let e=G(t[0]),n=Uint8Array.from(Ut(e.code));return t.length>1&&t[1]!=null&&(n=St([n,t[1]])),n}))}function df(r,t){if(r.size>0)return r.size/8;if(r.size===0)return 0;{let e=pe(t instanceof Uint8Array?t:Uint8Array.from(t));return e+Et(e)}}function Do(r){return"/"+r.trim().split("/").filter(t=>t).join("/")}var Or=class extends Error{static name="ParseError";name="ParseError";constructor(t){super(`Error parsing address: ${t}`)}};var pf=Symbol.for("nodejs.util.inspect.custom"),Ko=Symbol.for("@multiformats/js-multiaddr/multiaddr"),mf=[G("dns").code,G("dns4").code,G("dns6").code,G("dnsaddr").code],_o=class extends Error{constructor(t="No available resolver"){super(t),this.name="NoAvailableResolverError"}},qr=class r{bytes;#e;#t;#r;#n;[Ko]=!0;constructor(t){t==null&&(t="");let e;if(t instanceof Uint8Array)e=Uo(t);else if(typeof t=="string"){if(t.length>0&&t.charAt(0)!=="/")throw new Error(`multiaddr "${t}" must start with a "/"`);e=Li(t)}else if(Di(t))e=Uo(t.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=e.bytes,this.#e=e.string,this.#t=e.tuples,this.#r=e.stringTuples,this.#n=e.path}toString(){return this.#e}toJSON(){return this.toString()}toOptions(){let t,e,n,o,s="",i=G("tcp"),a=G("udp"),c=G("ip4"),f=G("ip6"),u=G("dns6"),l=G("ip6zone");for(let[x,w]of this.stringTuples())x===l.code&&(s=`%${w??""}`),mf.includes(x)&&(e=i.name==="tcp"?"tcp":"udp",o=443,n=`${w??""}${s}`,t=x===u.code?6:4),(x===i.code||x===a.code)&&(e=G(x).name==="tcp"?"tcp":"udp",o=parseInt(w??"")),(x===c.code||x===f.code)&&(e=G(x).name==="tcp"?"tcp":"udp",n=`${w??""}${s}`,t=x===f.code?6:4);if(t==null||e==null||n==null||o==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:t,host:n,transport:e,port:o}}protos(){return this.#t.map(([t])=>Object.assign({},G(t)))}protoCodes(){return this.#t.map(([t])=>t)}protoNames(){return this.#t.map(([t])=>G(t).name)}tuples(){return this.#t.map(([t,e])=>e==null?[t]:[t,e])}stringTuples(){return this.#r.map(([t,e])=>e==null?[t]:[t,e])}encapsulate(t){return t=new r(t),new r(this.toString()+t.toString())}decapsulate(t){let e=t.toString(),n=this.toString(),o=n.lastIndexOf(e);if(o<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${t.toString()}`);return new r(n.slice(0,o))}decapsulateCode(t){let e=this.tuples();for(let n=e.length-1;n>=0;n--)if(e[n][0]===t)return new r(Mr(e.slice(0,n)));return this}getPeerId(){try{let t=[];this.stringTuples().forEach(([n,o])=>{n===Ke.p2p.code&&t.push([n,o]),n===Ke["p2p-circuit"].code&&(t=[])});let e=t.pop();if(e?.[1]!=null){let n=e[1];return n[0]==="Q"||n[0]==="1"?k(Z.decode(`z${n}`),"base58btc"):k(tt.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){return this.#n}equals(t){return it(this.bytes,t.bytes)}async resolve(t){let e=this.protos().find(s=>s.resolvable);if(e==null)return[this];let n=Ci.get(e.name);if(n==null)throw new _o(`no available resolver for ${e.name}`);return(await n(this,t)).map(s=>er(s))}nodeAddress(){let t=this.toOptions();if(t.transport!=="tcp"&&t.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${t.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:t.family,address:t.host,port:t.port}}isThinWaistAddress(t){let e=(t??this).protos();return!(e.length!==2||e[0].code!==4&&e[0].code!==41||e[1].code!==6&&e[1].code!==273)}[pf](){return`Multiaddr(${this.#e})`}};var Ci=new Map;function Di(r){return!!r?.[Ko]}function er(r){return new qr(r)}var Ui="libp2p-peer-record",_i=Uint8Array.from([3,1]);var rr;(function(r){let t;(function(n){let o;n.codec=()=>(o==null&&(o=Ft((s,i,a={})=>{a.lengthDelimited!==!1&&i.fork(),s.multiaddr!=null&&s.multiaddr.byteLength>0&&(i.uint32(10),i.bytes(s.multiaddr)),a.lengthDelimited!==!1&&i.ldelim()},(s,i,a={})=>{let c={multiaddr:ut(0)},f=i==null?s.len:s.pos+i;for(;s.pos<f;){let u=s.uint32();switch(u>>>3){case 1:{c.multiaddr=s.bytes();break}default:{s.skipType(u&7);break}}}return c})),o),n.encode=s=>zt(s,n.codec()),n.decode=(s,i)=>Vt(s,n.codec(),i)})(t=r.AddressInfo||(r.AddressInfo={}));let e;r.codec=()=>(e==null&&(e=Ft((n,o,s={})=>{if(s.lengthDelimited!==!1&&o.fork(),n.peerId!=null&&n.peerId.byteLength>0&&(o.uint32(10),o.bytes(n.peerId)),n.seq!=null&&n.seq!==0n&&(o.uint32(16),o.uint64(n.seq)),n.addresses!=null)for(let i of n.addresses)o.uint32(26),r.AddressInfo.codec().encode(i,o);s.lengthDelimited!==!1&&o.ldelim()},(n,o,s={})=>{let i={peerId:ut(0),seq:0n,addresses:[]},a=o==null?n.len:n.pos+o;for(;n.pos<a;){let c=n.uint32();switch(c>>>3){case 1:{i.peerId=n.bytes();break}case 2:{i.seq=n.uint64();break}case 3:{if(s.limits?.addresses!=null&&i.addresses.length===s.limits.addresses)throw new Br('Decode error - map field "addresses" had too many elements');i.addresses.push(r.AddressInfo.codec().decode(n,n.uint32(),{limits:s.limits?.addresses$}));break}default:{n.skipType(c&7);break}}}return i})),e),r.encode=n=>zt(n,r.codec()),r.decode=(n,o)=>Vt(n,r.codec(),o)})(rr||(rr={}));var Hr=class r{static createFromProtobuf=t=>{let e=rr.decode(t),n=yi(ae(e.peerId)),o=(e.addresses??[]).map(i=>er(i.multiaddr)),s=e.seq;return new r({peerId:n,multiaddrs:o,seqNumber:s})};static DOMAIN=Ui;static CODEC=_i;peerId;multiaddrs;seqNumber;domain=r.DOMAIN;codec=r.CODEC;marshaled;constructor(t){let{peerId:e,multiaddrs:n,seqNumber:o}=t;this.peerId=e,this.multiaddrs=n??[],this.seqNumber=o??BigInt(Date.now())}marshal(){return this.marshaled==null&&(this.marshaled=rr.encode({peerId:this.peerId.toMultihash().bytes,seq:BigInt(this.seqNumber),addresses:this.multiaddrs.map(t=>({multiaddr:t.bytes}))})),this.marshaled}equals(t){return!(!(t instanceof r)||!this.peerId.equals(t.peerId)||this.seqNumber!==t.seqNumber||!gi(this.multiaddrs,t.multiaddrs))}};return ji(yf);})();
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/weierstrass.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/_shortw_utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
return Libp2PPeerRecord}));
